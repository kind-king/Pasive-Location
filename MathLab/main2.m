clear;      % звільнити пам'ять MATLAB від усіх змінних
close all;  % закрити всі графічні вінка

%currentCharacterEncoding = slCharacterEncoding();
slCharacterEncoding('windows-1251'); 

% налаштування параметрів графічних вікон для виведення графіків
  scrsz = get(0,'ScreenSize');                                              % отримати розміри екрану
  set(0,'defaultFigurePosition',[scrsz(3)*0/4+9 48 scrsz(3)*4/4-18 scrsz(4)-124])  % отримати розміри екрану
  set(0,'defaultTextFontName','MS Sans Serif')                              % встановити фонт для відображення кирилиці

  format short g

 
 
  
% Begin const data
d0 = 0;      p0 = 0;                 z0 = -0 
d1 = 20;     p1 = (0/180)*pi;        z1 =  0.100; 
d2 = 20;     p2 = (120/180)*pi;      z2 =  0.020; 
d3 = 20;     p3 = (240/180)*pi;      z3 =  -0.100;
 
% Пеленг цілі від координат: [0,0,0]
angle_ = 0:1:360;
%Peling0 = [9000, (angle_/180)*pi, 2 + z0]; %147.23 332.77   
%330 - 150
%332.77 - 147.23


Peling0(:,2) = (angle_/180)*pi;
Peling0(:,1) = 600;
Peling0(:,3) = 2 + z0;

NoiseError = 0;






% DPZ To XYZ_2
% the x-axis looks to the north

v = DPZ_To_XYZ( d0, p0, z0 );
x00 = v(1); y00 = v(2) ;z00 = v(3);
v = DPZ_To_XYZ( d1, p1, z1 );
x10 = v(1); y10 = v(2) ;z10 = v(3);
v = DPZ_To_XYZ( d2, p2, z2 );
x20 = v(1); y20 = v(2) ;z20 = v(3);
v = DPZ_To_XYZ( d3, p3, z3 );
x30 = v(1); y30 = v(2) ;z30 = v(3);

% XYZ_2 To xyz_1

x01 = 0;         y01 = 0;          z01 = 0;                             %
x11 = x10-x00;   y11 = y10-y00;    z11 = z10-z00;
x21 = x20-x00;   y21 = y20-y00;    z21 = z20-z00;
x31 = x30-x00;   y31 = y30-y00;    z31 = z30-z00;

a = atan(y11/x11);
%x12 = (x11^2+y11^2)^(1/2);   y12 = 0;                      z12 = z11; % не визначений знак
x12 = x11*cos(a)+y11*sin(a); y12 = 0;                      z12 = z11;
x22 = x21*cos(a)+y21*sin(a); y22 = -x21*sin(a)+y21*cos(a); z22 = z21;
x32 = x31*cos(a)+y31*sin(a); y32 = -x31*sin(a)+y31*cos(a); z32 = z31;

b = atan(z12/x12);
%x13 = (x12^2+z12^2)^(1/2);   y13 = y12;  z13 = 0;                       % 
x13 = x12*cos(b)+z12*sin(b); y13 = y12;  z13 = 0;                       % 
x23 = x22*cos(b)+z22*sin(b); y23 = y22;  z23 = -x22*sin(b)+z22*cos(b);
x33 = x32*cos(b)+z32*sin(b); y33 = y32;  z33 = -x32*sin(b)+z32*cos(b);

g = atan(z23/y23);
%x24 = x23;  y24 = (y23^2+z23^2)^(1/2);    z24 = 0;                      %
x24 = x23;  y24 = y23*cos(g)+z23*sin(g);  z24 = 0;                      %
x34 = x33;  y34 = y33*cos(g)+z33*sin(g);  z34 = -y33*sin(g)+z33*cos(g); %

%_________________________________
x_1 = x13;  y_1 = y13;  z_1 = z13;  
x_2 = x23;  y_2 = y24;  z_2 = z24;
x_3 = x34;  y_3 = y34;  z_3 = z34;

%x30
%y30
%z30
%Station3 = xyz_1_To_XYZ_2( x_3,y_3,z_3,a,b,g,z00,y00,x00)
%xyz_To_DPZ( Station3(1),Station3(2),Station3(3) )

% OR

%x_1 = 35;   y_1 = 0;    z_1 = 0;
%x_2 = -10;  y_2 = 32;   z_2 = 0;
%x_3 = 11;   y_3 = -23;  z_3 = 2;
%_________________________________

'Координати трьох залежних РЛС в повернутій декартовій системі'
v_0 = [x_1,y_1,z_1; x_2,y_2,z_2; x_3,y_3,z_3]
'Кути, в градусах, на які була повернута система координат в площинах X-Y, X-Z, Y-Z відповідно'
angle = [a.*180 b.*180 g.*180]

%XYZ_2_To_xyz_1( x10,y10,z10,a,b,g,z00,y00,x00) %

% Input data

% Пелінг від координат: [0,0,0]
'Пелінг цілі'
Peling0
'Координати цілі в нормальній декартовій системі'
v = DPZ_To_XYZ( Peling0(:,1),Peling0(:,2),Peling0(:,3) )
'Координати цілі в повернутій декартовій системі'
Target = XYZ_2_To_xyz_1( v(:,1),v(:,2),v(:,3),a,b,g,z00,y00,x00)
%Target = [600,150,30];
%Vector = xyz_1_To_XYZ_2( Target(:,1),Target(:,2),Target(:,3),a,b,g,z00,y00,x00 )
%Peling = xyz_To_DPZ( Vector(:,1),Vector(:,2),Vector(:,3) 

% syms R_1 R_2 R_3
% 
% fun = @(R, R_1, R_2, R_3) ( ...
% ( R_1^4*x_2^2*y_3^2+R_1^4*x_2^2*z_3^2-2*R_1^4*x_2*x_3*y_2*y_3+R_1^4*x_3^2*y_2^2+R_1^4*y_2^2*z_3^2-2*R_1^2*R_2^2*x_1*x_2*y_3^2-2*R_1^2*R_2^2*x_1*x_2*z_3^2+2*R_1^2*R_2^2*x_1*x_3*y_2*y_3+2*R_1^2*R_3^2*x_1*x_2*y_2*y_3-2*R_1^2*R_3^2*x_1*x_3*y_2^2-2*R_1^2*x_1^2*x_2^2*y_3^2-2*R_1^2*x_1^2*x_2^2*z_3^2+4*R_1^2*x_1^2*x_2*x_3*y_2*y_3-2*R_1^2*x_1^2*x_3^2*y_2^2-2*R_1^2*x_1^2*y_2^2*z_3^2+2*R_1^2*x_1*x_2^3*y_3^2+2*R_1^2*x_1*x_2^3*z_3^2-2*R_1^2*x_1*x_2^2*x_3*y_2*y_3-2*R_1^2*x_1*x_2*x_3^2*y_2*y_3+2*R_1^2*x_1*x_2*y_2^2*y_3^2+2*R_1^2*x_1*x_2*y_2^2*z_3^2-2*R_1^2*x_1*x_2*y_2*y_3^3-2*R_1^2*x_1*x_2*y_2*y_3*z_3^2+2*R_1^2*x_1*x_3^3*y_2^2-2*R_1^2*x_1*x_3*y_2^3*y_3+2*R_1^2*x_1*x_3*y_2^2*y_3^2+2*R_1^2*x_1*x_3*y_2^2*z_3^2+R_2^4*x_1^2*y_3^2+R_2^4*x_1^2*z_3^2-2*R_2^2*R_3^2*x_1^2*y_2*y_3+2*R_2^2*x_1^3*x_2*y_3^2+2*R_2^2*x_1^3*x_2*z_3^2-2*R_2^2*x_1^3*x_3*y_2*y_3-2*R_2^2*x_1^2*x_2^2*y_3^2-2*R_2^2*x_1^2*x_2^2*z_3^2+2*R_2^2*x_1^2*x_3^2*y_2*y_3-2*R_2^2*x_1^2*y_2^2*y_3^2-2*R_2^2*x_1^2*y_2^2*z_3^2+2*R_2^2*x_1^2*y_2*y_3^3+2*R_2^2*x_1^2*y_2*y_3*z_3^2+R_3^4*x_1^2*y_2^2-2*R_3^2*x_1^3*x_2*y_2*y_3+2*R_3^2*x_1^3*x_3*y_2^2+2*R_3^2*x_1^2*x_2^2*y_2*y_3-2*R_3^2*x_1^2*x_3^2*y_2^2+2*R_3^2*x_1^2*y_2^3*y_3-2*R_3^2*x_1^2*y_2^2*y_3^2-2*R_3^2*x_1^2*y_2^2*z_3^2+x_1^4*x_2^2*y_3^2+x_1^4*x_2^2*z_3^2-2*x_1^4*x_2*x_3*y_2*y_3+x_1^4*x_3^2*y_2^2+x_1^4*y_2^2*z_3^2-2*x_1^3*x_2^3*y_3^2-2*x_1^3*x_2^3*z_3^2+2*x_1^3*x_2^2*x_3*y_2*y_3+2*x_1^3*x_2*x_3^2*y_2*y_3-2*x_1^3*x_2*y_2^2*y_3^2-2*x_1^3*x_2*y_2^2*z_3^2+2*x_1^3*x_2*y_2*y_3^3+2*x_1^3*x_2*y_2*y_3*z_3^2-2*x_1^3*x_3^3*y_2^2+2*x_1^3*x_3*y_2^3*y_3-2*x_1^3*x_3*y_2^2*y_3^2-2*x_1^3*x_3*y_2^2*z_3^2+x_1^2*x_2^4*y_3^2+x_1^2*x_2^4*z_3^2-2*x_1^2*x_2^2*x_3^2*y_2*y_3+2*x_1^2*x_2^2*y_2^2*y_3^2+2*x_1^2*x_2^2*y_2^2*z_3^2-2*x_1^2*x_2^2*y_2*y_3^3-2*x_1^2*x_2^2*y_2*y_3*z_3^2+x_1^2*x_3^4*y_2^2-2*x_1^2*x_3^2*y_2^3*y_3+2*x_1^2*x_3^2*y_2^2*y_3^2+2*x_1^2*x_3^2*y_2^2*z_3^2+x_1^2*y_2^4*y_3^2+x_1^2*y_2^4*z_3^2-2*x_1^2*y_2^3*y_3^3-2*x_1^2*y_2^3*y_3*z_3^2+x_1^2*y_2^2*y_3^4+2*x_1^2*y_2^2*y_3^2*z_3^2+x_1^2*y_2^2*z_3^4 ) / ...
%     (4*x_1^2*y_2^2*z_3^2) + ...
% ( R_1^3*x_2^2*y_3^2+R_1^3*x_2^2*z_3^2-2*R_1^3*x_2*x_3*y_2*y_3+R_1^3*x_3^2*y_2^2+R_1^3*y_2^2*z_3^2-R_1^2*R_2*x_1*x_2*y_3^2-R_1^2*R_2*x_1*x_2*z_3^2+R_1^2*R_2*x_1*x_3*y_2*y_3+R_1^2*R_3*x_1*x_2*y_2*y_3-R_1^2*R_3*x_1*x_3*y_2^2-R_1*R_2^2*x_1*x_2*y_3^2-R_1*R_2^2*x_1*x_2*z_3^2+R_1*R_2^2*x_1*x_3*y_2*y_3+R_1*R_3^2*x_1*x_2*y_2*y_3-R_1*R_3^2*x_1*x_3*y_2^2-R_1*x_1^2*x_2^2*y_3^2-R_1*x_1^2*x_2^2*z_3^2+2*R_1*x_1^2*x_2*x_3*y_2*y_3-R_1*x_1^2*x_3^2*y_2^2-R_1*x_1^2*y_2^2*z_3^2+R_1*x_1*x_2^3*y_3^2+R_1*x_1*x_2^3*z_3^2-R_1*x_1*x_2^2*x_3*y_2*y_3-R_1*x_1*x_2*x_3^2*y_2*y_3+R_1*x_1*x_2*y_2^2*y_3^2+R_1*x_1*x_2*y_2^2*z_3^2-R_1*x_1*x_2*y_2*y_3^3-R_1*x_1*x_2*y_2*y_3*z_3^2+R_1*x_1*x_3^3*y_2^2-R_1*x_1*x_3*y_2^3*y_3+R_1*x_1*x_3*y_2^2*y_3^2+R_1*x_1*x_3*y_2^2*z_3^2+R_2^3*x_1^2*y_3^2+R_2^3*x_1^2*z_3^2-R_2^2*R_3*x_1^2*y_2*y_3-R_2*R_3^2*x_1^2*y_2*y_3+R_2*x_1^3*x_2*y_3^2+R_2*x_1^3*x_2*z_3^2-R_2*x_1^3*x_3*y_2*y_3-R_2*x_1^2*x_2^2*y_3^2-R_2*x_1^2*x_2^2*z_3^2+R_2*x_1^2*x_3^2*y_2*y_3-R_2*x_1^2*y_2^2*y_3^2-R_2*x_1^2*y_2^2*z_3^2+R_2*x_1^2*y_2*y_3^3+R_2*x_1^2*y_2*y_3*z_3^2+R_3^3*x_1^2*y_2^2-R_3*x_1^3*x_2*y_2*y_3+R_3*x_1^3*x_3*y_2^2+R_3*x_1^2*x_2^2*y_2*y_3-R_3*x_1^2*x_3^2*y_2^2+R_3*x_1^2*y_2^3*y_3-R_3*x_1^2*y_2^2*y_3^2-R_3*x_1^2*y_2^2*z_3^2 ) / ...
%     (x_1^2*y_2^2*z_3^2) * R + ...
% ( R_1^2*x_2^2*y_3^2+R_1^2*x_2^2*z_3^2-2*R_1^2*x_2*x_3*y_2*y_3+R_1^2*x_3^2*y_2^2+R_1^2*y_2^2*z_3^2-2*R_1*R_2*x_1*x_2*y_3^2-2*R_1*R_2*x_1*x_2*z_3^2+2*R_1*R_2*x_1*x_3*y_2*y_3+2*R_1*R_3*x_1*x_2*y_2*y_3-2*R_1*R_3*x_1*x_3*y_2^2+R_2^2*x_1^2*y_3^2+R_2^2*x_1^2*z_3^2-2*R_2*R_3*x_1^2*y_2*y_3+R_3^2*x_1^2*y_2^2-x_1^2*y_2^2*z_3^2 ) / ...        
%     (x_1^2*y_2^2*z_3^2) * R^2 );
% 
% syms R
% R = @(R_1,R_2,R_3) solve(fun(R, R_1, R_2, R_3), R, 'MaxDegree', 4);

% R1 = @(R_1,R_2,R_3) (R_1*x_1^2*x_2^2*y_3^2 - R_1^3*x_3^2*y_2^2 - R_2^3*x_1^2*y_3^2 - R_3^3*x_1^2*y_2^2 - R_1^3*x_2^2*z_3^2 - R_2^3*x_1^2*z_3^2 - R_1^3*y_2^2*z_3^2 - R_1^3*x_2^2*y_3^2 + R_1*x_1^2*x_3^2*y_2^2 + R_2*x_1^2*x_2^2*y_3^2 + R_3*x_1^2*x_3^2*y_2^2 + R_1*x_1^2*x_2^2*z_3^2 + R_2*x_1^2*x_2^2*z_3^2 + R_2*x_1^2*y_2^2*y_3^2 + R_3*x_1^2*y_2^2*y_3^2 + R_1*x_1^2*y_2^2*z_3^2 + R_2*x_1^2*y_2^2*z_3^2 + R_3*x_1^2*y_2^2*z_3^2 + x_1*y_2*z_3*(2*R_1^4*R_2*R_3*x_2*x_3 - R_1^4*R_2^2*y_3^2 - R_1^4*R_2^2*z_3^2 - R_1^4*R_2^2*x_3^2 + 2*R_1^4*R_2*R_3*y_2*y_3 - R_1^4*R_3^2*x_2^2 - R_1^4*R_3^2*y_2^2 + R_1^4*x_2^2*y_3^2 + R_1^4*x_2^2*z_3^2 - 2*R_1^4*x_2*x_3*y_2*y_3 + R_1^4*x_3^2*y_2^2 + R_1^4*y_2^2*z_3^2 + 2*R_1^3*R_2^3*x_3^2 + 2*R_1^3*R_2^3*y_3^2 + 2*R_1^3*R_2^3*z_3^2 - 2*R_1^3*R_2^2*R_3*x_2*x_3 - 2*R_1^3*R_2^2*R_3*y_2*y_3 - 2*R_1^3*R_2*R_3^2*x_2*x_3 - 2*R_1^3*R_2*R_3^2*y_2*y_3 - 2*R_1^3*R_2*x_2^2*x_3^2 - 2*R_1^3*R_2*x_2^2*y_3^2 - 2*R_1^3*R_2*x_2^2*z_3^2 + 2*R_1^3*R_2*x_2*x_3^3 + 2*R_1^3*R_2*x_2*x_3*y_3^2 + 2*R_1^3*R_2*x_2*x_3*z_3^2 - 2*R_1^3*R_2*x_3^2*y_2^2 + 2*R_1^3*R_2*x_3^2*y_2*y_3 - 2*R_1^3*R_2*y_2^2*y_3^2 - 2*R_1^3*R_2*y_2^2*z_3^2 + 2*R_1^3*R_2*y_2*y_3^3 + 2*R_1^3*R_2*y_2*y_3*z_3^2 + 2*R_1^3*R_3^3*x_2^2 + 2*R_1^3*R_3^3*y_2^2 + 2*R_1^3*R_3*x_2^3*x_3 - 2*R_1^3*R_3*x_2^2*x_3^2 + 2*R_1^3*R_3*x_2^2*y_2*y_3 - 2*R_1^3*R_3*x_2^2*y_3^2 - 2*R_1^3*R_3*x_2^2*z_3^2 + 2*R_1^3*R_3*x_2*x_3*y_2^2 - 2*R_1^3*R_3*x_3^2*y_2^2 + 2*R_1^3*R_3*y_2^3*y_3 - 2*R_1^3*R_3*y_2^2*y_3^2 - 2*R_1^3*R_3*y_2^2*z_3^2 - R_1^2*R_2^4*x_3^2 - R_1^2*R_2^4*y_3^2 - R_1^2*R_2^4*z_3^2 - 2*R_1^2*R_2^3*R_3*x_1*x_3 + 2*R_1^2*R_2^2*R_3^2*x_1*x_2 + 2*R_1^2*R_2^2*R_3^2*x_1*x_3 + 2*R_1^2*R_2^2*R_3^2*x_2*x_3 + 2*R_1^2*R_2^2*R_3^2*y_2*y_3 + 2*R_1^2*R_2^2*x_1^2*x_3^2 + 2*R_1^2*R_2^2*x_1^2*y_3^2 + 2*R_1^2*R_2^2*x_1^2*z_3^2 - 2*R_1^2*R_2^2*x_1*x_2*y_3^2 - 2*R_1^2*R_2^2*x_1*x_2*z_3^2 - 2*R_1^2*R_2^2*x_1*x_3^3 + 2*R_1^2*R_2^2*x_1*x_3*y_2*y_3 - 2*R_1^2*R_2^2*x_1*x_3*y_3^2 - 2*R_1^2*R_2^2*x_1*x_3*z_3^2 + 2*R_1^2*R_2^2*x_2^2*x_3^2 + 2*R_1^2*R_2^2*x_2^2*y_3^2 + 2*R_1^2*R_2^2*x_2^2*z_3^2 - 2*R_1^2*R_2^2*x_2*x_3^3 - 2*R_1^2*R_2^2*x_2*x_3*y_3^2 - 2*R_1^2*R_2^2*x_2*x_3*z_3^2 + 2*R_1^2*R_2^2*x_3^2*y_2^2 - 2*R_1^2*R_2^2*x_3^2*y_2*y_3 + 2*R_1^2*R_2^2*y_2^2*y_3^2 + 2*R_1^2*R_2^2*y_2^2*z_3^2 - 2*R_1^2*R_2^2*y_2*y_3^3 - 2*R_1^2*R_2^2*y_2*y_3*z_3^2 - 2*R_1^2*R_2*R_3^3*x_1*x_2 - 4*R_1^2*R_2*R_3*x_1^2*x_2*x_3 - 4*R_1^2*R_2*R_3*x_1^2*y_2*y_3 + 2*R_1^2*R_2*R_3*x_1*x_2^2*x_3 + 2*R_1^2*R_2*R_3*x_1*x_2*x_3^2 + 2*R_1^2*R_2*R_3*x_1*x_2*y_3^2 + 2*R_1^2*R_2*R_3*x_1*x_2*z_3^2 + 2*R_1^2*R_2*R_3*x_1*x_3*y_2^2 - R_1^2*R_3^4*x_2^2 - R_1^2*R_3^4*y_2^2 + 2*R_1^2*R_3^2*x_1^2*x_2^2 + 2*R_1^2*R_3^2*x_1^2*y_2^2 - 2*R_1^2*R_3^2*x_1*x_2^3 - 2*R_1^2*R_3^2*x_1*x_2*y_2^2 + 2*R_1^2*R_3^2*x_1*x_2*y_2*y_3 - 2*R_1^2*R_3^2*x_1*x_3*y_2^2 - 2*R_1^2*R_3^2*x_2^3*x_3 + 2*R_1^2*R_3^2*x_2^2*x_3^2 - 2*R_1^2*R_3^2*x_2^2*y_2*y_3 + 2*R_1^2*R_3^2*x_2^2*y_3^2 + 2*R_1^2*R_3^2*x_2^2*z_3^2 - 2*R_1^2*R_3^2*x_2*x_3*y_2^2 + 2*R_1^2*R_3^2*x_3^2*y_2^2 - 2*R_1^2*R_3^2*y_2^3*y_3 + 2*R_1^2*R_3^2*y_2^2*y_3^2 + 2*R_1^2*R_3^2*y_2^2*z_3^2 - 2*R_1^2*x_1^2*x_2^2*y_3^2 - 2*R_1^2*x_1^2*x_2^2*z_3^2 + 4*R_1^2*x_1^2*x_2*x_3*y_2*y_3 - 2*R_1^2*x_1^2*x_3^2*y_2^2 - 2*R_1^2*x_1^2*y_2^2*z_3^2 + 2*R_1^2*x_1*x_2^3*y_3^2 + 2*R_1^2*x_1*x_2^3*z_3^2 - 2*R_1^2*x_1*x_2^2*x_3*y_2*y_3 - 2*R_1^2*x_1*x_2*x_3^2*y_2*y_3 + 2*R_1^2*x_1*x_2*y_2^2*y_3^2 + 2*R_1^2*x_1*x_2*y_2^2*z_3^2 - 2*R_1^2*x_1*x_2*y_2*y_3^3 - 2*R_1^2*x_1*x_2*y_2*y_3*z_3^2 + 2*R_1^2*x_1*x_3^3*y_2^2 - 2*R_1^2*x_1*x_3*y_2^3*y_3 + 2*R_1^2*x_1*x_3*y_2^2*y_3^2 + 2*R_1^2*x_1*x_3*y_2^2*z_3^2 - R_1^2*x_2^4*x_3^2 - R_1^2*x_2^4*y_3^2 - R_1^2*x_2^4*z_3^2 + 2*R_1^2*x_2^3*x_3^3 + 2*R_1^2*x_2^3*x_3*y_3^2 + 2*R_1^2*x_2^3*x_3*z_3^2 - R_1^2*x_2^2*x_3^4 - 2*R_1^2*x_2^2*x_3^2*y_2^2 + 2*R_1^2*x_2^2*x_3^2*y_2*y_3 - 2*R_1^2*x_2^2*x_3^2*y_3^2 - 2*R_1^2*x_2^2*x_3^2*z_3^2 - 2*R_1^2*x_2^2*y_2^2*y_3^2 - 2*R_1^2*x_2^2*y_2^2*z_3^2 + 2*R_1^2*x_2^2*y_2*y_3^3 + 2*R_1^2*x_2^2*y_2*y_3*z_3^2 - R_1^2*x_2^2*y_3^4 - 2*R_1^2*x_2^2*y_3^2*z_3^2 - R_1^2*x_2^2*z_3^4 + 2*R_1^2*x_2*x_3^3*y_2^2 + 2*R_1^2*x_2*x_3*y_2^2*y_3^2 + 2*R_1^2*x_2*x_3*y_2^2*z_3^2 - R_1^2*x_3^4*y_2^2 - R_1^2*x_3^2*y_2^4 + 2*R_1^2*x_3^2*y_2^3*y_3 - 2*R_1^2*x_3^2*y_2^2*y_3^2 - 2*R_1^2*x_3^2*y_2^2*z_3^2 - R_1^2*y_2^4*y_3^2 - R_1^2*y_2^4*z_3^2 + 2*R_1^2*y_2^3*y_3^3 + 2*R_1^2*y_2^3*y_3*z_3^2 - R_1^2*y_2^2*y_3^4 - 2*R_1^2*y_2^2*y_3^2*z_3^2 - R_1^2*y_2^2*z_3^4 + 2*R_1*R_2^4*R_3*x_1*x_3 - 2*R_1*R_2^3*R_3^2*x_1*x_3 - 2*R_1*R_2^3*x_1^2*x_3^2 - 2*R_1*R_2^3*x_1^2*y_3^2 - 2*R_1*R_2^3*x_1^2*z_3^2 + 2*R_1*R_2^3*x_1*x_3^3 + 2*R_1*R_2^3*x_1*x_3*y_3^2 + 2*R_1*R_2^3*x_1*x_3*z_3^2 - 2*R_1*R_2^2*R_3^3*x_1*x_2 + 2*R_1*R_2^2*R_3*x_1^2*x_2*x_3 + 2*R_1*R_2^2*R_3*x_1^2*y_2*y_3 - 4*R_1*R_2^2*R_3*x_1*x_2^2*x_3 + 2*R_1*R_2^2*R_3*x_1*x_2*x_3^2 + 2*R_1*R_2^2*R_3*x_1*x_2*y_3^2 + 2*R_1*R_2^2*R_3*x_1*x_2*z_3^2 - 4*R_1*R_2^2*R_3*x_1*x_3*y_2^2 + 2*R_1*R_2*R_3^4*x_1*x_2 + 2*R_1*R_2*R_3^2*x_1^2*x_2*x_3 + 2*R_1*R_2*R_3^2*x_1^2*y_2*y_3 + 2*R_1*R_2*R_3^2*x_1*x_2^2*x_3 - 4*R_1*R_2*R_3^2*x_1*x_2*x_3^2 - 4*R_1*R_2*R_3^2*x_1*x_2*y_3^2 - 4*R_1*R_2*R_3^2*x_1*x_2*z_3^2 + 2*R_1*R_2*R_3^2*x_1*x_3*y_2^2 + 2*R_1*R_2*x_1^2*x_2^2*x_3^2 + 2*R_1*R_2*x_1^2*x_2^2*y_3^2 + 2*R_1*R_2*x_1^2*x_2^2*z_3^2 - 2*R_1*R_2*x_1^2*x_2*x_3^3 - 2*R_1*R_2*x_1^2*x_2*x_3*y_3^2 - 2*R_1*R_2*x_1^2*x_2*x_3*z_3^2 + 2*R_1*R_2*x_1^2*x_3^2*y_2^2 - 2*R_1*R_2*x_1^2*x_3^2*y_2*y_3 + 2*R_1*R_2*x_1^2*y_2^2*y_3^2 + 2*R_1*R_2*x_1^2*y_2^2*z_3^2 - 2*R_1*R_2*x_1^2*y_2*y_3^3 - 2*R_1*R_2*x_1^2*y_2*y_3*z_3^2 - 2*R_1*R_2*x_1*x_2^2*x_3^3 - 2*R_1*R_2*x_1*x_2^2*x_3*y_3^2 - 2*R_1*R_2*x_1*x_2^2*x_3*z_3^2 + 2*R_1*R_2*x_1*x_2*x_3^4 + 4*R_1*R_2*x_1*x_2*x_3^2*y_3^2 + 4*R_1*R_2*x_1*x_2*x_3^2*z_3^2 + 2*R_1*R_2*x_1*x_2*y_3^4 + 4*R_1*R_2*x_1*x_2*y_3^2*z_3^2 + 2*R_1*R_2*x_1*x_2*z_3^4 - 2*R_1*R_2*x_1*x_3^3*y_2^2 - 2*R_1*R_2*x_1*x_3*y_2^2*y_3^2 - 2*R_1*R_2*x_1*x_3*y_2^2*z_3^2 - 2*R_1*R_3^3*x_1^2*x_2^2 - 2*R_1*R_3^3*x_1^2*y_2^2 + 2*R_1*R_3^3*x_1*x_2^3 + 2*R_1*R_3^3*x_1*x_2*y_2^2 - 2*R_1*R_3*x_1^2*x_2^3*x_3 + 2*R_1*R_3*x_1^2*x_2^2*x_3^2 - 2*R_1*R_3*x_1^2*x_2^2*y_2*y_3 + 2*R_1*R_3*x_1^2*x_2^2*y_3^2 + 2*R_1*R_3*x_1^2*x_2^2*z_3^2 - 2*R_1*R_3*x_1^2*x_2*x_3*y_2^2 + 2*R_1*R_3*x_1^2*x_3^2*y_2^2 - 2*R_1*R_3*x_1^2*y_2^3*y_3 + 2*R_1*R_3*x_1^2*y_2^2*y_3^2 + 2*R_1*R_3*x_1^2*y_2^2*z_3^2 + 2*R_1*R_3*x_1*x_2^4*x_3 - 2*R_1*R_3*x_1*x_2^3*x_3^2 - 2*R_1*R_3*x_1*x_2^3*y_3^2 - 2*R_1*R_3*x_1*x_2^3*z_3^2 + 4*R_1*R_3*x_1*x_2^2*x_3*y_2^2 - 2*R_1*R_3*x_1*x_2*x_3^2*y_2^2 - 2*R_1*R_3*x_1*x_2*y_2^2*y_3^2 - 2*R_1*R_3*x_1*x_2*y_2^2*z_3^2 + 2*R_1*R_3*x_1*x_3*y_2^4 - R_2^4*R_3^2*x_1^2 + R_2^4*x_1^2*y_3^2 + R_2^4*x_1^2*z_3^2 + 2*R_2^3*R_3^3*x_1^2 + 2*R_2^3*R_3*x_1^3*x_3 - 2*R_2^3*R_3*x_1^2*x_3^2 - 2*R_2^3*R_3*x_1^2*y_3^2 - 2*R_2^3*R_3*x_1^2*z_3^2 - R_2^2*R_3^4*x_1^2 - 2*R_2^2*R_3^2*x_1^3*x_2 - 2*R_2^2*R_3^2*x_1^3*x_3 + 2*R_2^2*R_3^2*x_1^2*x_2^2 + 2*R_2^2*R_3^2*x_1^2*x_3^2 + 2*R_2^2*R_3^2*x_1^2*y_2^2 - 2*R_2^2*R_3^2*x_1^2*y_2*y_3 + 2*R_2^2*R_3^2*x_1^2*y_3^2 + 2*R_2^2*R_3^2*x_1^2*z_3^2 - R_2^2*x_1^4*x_3^2 - R_2^2*x_1^4*y_3^2 - R_2^2*x_1^4*z_3^2 + 2*R_2^2*x_1^3*x_2*y_3^2 + 2*R_2^2*x_1^3*x_2*z_3^2 + 2*R_2^2*x_1^3*x_3^3 - 2*R_2^2*x_1^3*x_3*y_2*y_3 + 2*R_2^2*x_1^3*x_3*y_3^2 + 2*R_2^2*x_1^3*x_3*z_3^2 - 2*R_2^2*x_1^2*x_2^2*y_3^2 - 2*R_2^2*x_1^2*x_2^2*z_3^2 - R_2^2*x_1^2*x_3^4 + 2*R_2^2*x_1^2*x_3^2*y_2*y_3 - 2*R_2^2*x_1^2*x_3^2*y_3^2 - 2*R_2^2*x_1^2*x_3^2*z_3^2 - 2*R_2^2*x_1^2*y_2^2*y_3^2 - 2*R_2^2*x_1^2*y_2^2*z_3^2 + 2*R_2^2*x_1^2*y_2*y_3^3 + 2*R_2^2*x_1^2*y_2*y_3*z_3^2 - R_2^2*x_1^2*y_3^4 - 2*R_2^2*x_1^2*y_3^2*z_3^2 - R_2^2*x_1^2*z_3^4 + 2*R_2*R_3^3*x_1^3*x_2 - 2*R_2*R_3^3*x_1^2*x_2^2 - 2*R_2*R_3^3*x_1^2*y_2^2 + 2*R_2*R_3*x_1^4*x_2*x_3 + 2*R_2*R_3*x_1^4*y_2*y_3 - 2*R_2*R_3*x_1^3*x_2^2*x_3 - 2*R_2*R_3*x_1^3*x_2*x_3^2 - 2*R_2*R_3*x_1^3*x_2*y_3^2 - 2*R_2*R_3*x_1^3*x_2*z_3^2 - 2*R_2*R_3*x_1^3*x_3*y_2^2 + 2*R_2*R_3*x_1^2*x_2^2*x_3^2 + 2*R_2*R_3*x_1^2*x_2^2*y_3^2 + 2*R_2*R_3*x_1^2*x_2^2*z_3^2 + 2*R_2*R_3*x_1^2*x_3^2*y_2^2 + 2*R_2*R_3*x_1^2*y_2^2*y_3^2 + 2*R_2*R_3*x_1^2*y_2^2*z_3^2 + R_3^4*x_1^2*y_2^2 - R_3^2*x_1^4*x_2^2 - R_3^2*x_1^4*y_2^2 + 2*R_3^2*x_1^3*x_2^3 + 2*R_3^2*x_1^3*x_2*y_2^2 - 2*R_3^2*x_1^3*x_2*y_2*y_3 + 2*R_3^2*x_1^3*x_3*y_2^2 - R_3^2*x_1^2*x_2^4 - 2*R_3^2*x_1^2*x_2^2*y_2^2 + 2*R_3^2*x_1^2*x_2^2*y_2*y_3 - 2*R_3^2*x_1^2*x_3^2*y_2^2 - R_3^2*x_1^2*y_2^4 + 2*R_3^2*x_1^2*y_2^3*y_3 - 2*R_3^2*x_1^2*y_2^2*y_3^2 - 2*R_3^2*x_1^2*y_2^2*z_3^2 + x_1^4*x_2^2*y_3^2 + x_1^4*x_2^2*z_3^2 - 2*x_1^4*x_2*x_3*y_2*y_3 + x_1^4*x_3^2*y_2^2 + x_1^4*y_2^2*z_3^2 - 2*x_1^3*x_2^3*y_3^2 - 2*x_1^3*x_2^3*z_3^2 + 2*x_1^3*x_2^2*x_3*y_2*y_3 + 2*x_1^3*x_2*x_3^2*y_2*y_3 - 2*x_1^3*x_2*y_2^2*y_3^2 - 2*x_1^3*x_2*y_2^2*z_3^2 + 2*x_1^3*x_2*y_2*y_3^3 + 2*x_1^3*x_2*y_2*y_3*z_3^2 - 2*x_1^3*x_3^3*y_2^2 + 2*x_1^3*x_3*y_2^3*y_3 - 2*x_1^3*x_3*y_2^2*y_3^2 - 2*x_1^3*x_3*y_2^2*z_3^2 + x_1^2*x_2^4*y_3^2 + x_1^2*x_2^4*z_3^2 - 2*x_1^2*x_2^2*x_3^2*y_2*y_3 + 2*x_1^2*x_2^2*y_2^2*y_3^2 + 2*x_1^2*x_2^2*y_2^2*z_3^2 - 2*x_1^2*x_2^2*y_2*y_3^3 - 2*x_1^2*x_2^2*y_2*y_3*z_3^2 + x_1^2*x_3^4*y_2^2 - 2*x_1^2*x_3^2*y_2^3*y_3 + 2*x_1^2*x_3^2*y_2^2*y_3^2 + 2*x_1^2*x_3^2*y_2^2*z_3^2 + x_1^2*y_2^4*y_3^2 + x_1^2*y_2^4*z_3^2 - 2*x_1^2*y_2^3*y_3^3 - 2*x_1^2*y_2^3*y_3*z_3^2 + x_1^2*y_2^2*y_3^4 + 2*x_1^2*y_2^2*y_3^2*z_3^2 + x_1^2*y_2^2*z_3^4)^(1/2) - R_1*x_1*x_2^3*y_3^2 - R_1*x_1*x_3^3*y_2^2 - R_2*x_1^3*x_2*y_3^2 - R_3*x_1^3*x_3*y_2^2 - R_1*x_1*x_2^3*z_3^2 - R_2*x_1^2*y_2*y_3^3 - R_2*x_1^3*x_2*z_3^2 - R_3*x_1^2*y_2^3*y_3 + R_1*R_2^2*x_1*x_2*y_3^2 + R_1^2*R_2*x_1*x_2*y_3^2 + R_1*R_3^2*x_1*x_3*y_2^2 + R_1^2*R_3*x_1*x_3*y_2^2 + R_1*R_2^2*x_1*x_2*z_3^2 + R_1^2*R_2*x_1*x_2*z_3^2 + R_2*R_3^2*x_1^2*y_2*y_3 + R_2^2*R_3*x_1^2*y_2*y_3 - R_1*x_1*x_2*y_2^2*y_3^2 - R_1*x_1*x_3*y_2^2*y_3^2 - R_2*x_1^2*x_3^2*y_2*y_3 - R_3*x_1^2*x_2^2*y_2*y_3 - R_1*x_1*x_2*y_2^2*z_3^2 - R_1*x_1*x_3*y_2^2*z_3^2 - R_2*x_1^2*y_2*y_3*z_3^2 + R_1*x_1*x_2*y_2*y_3^3 + R_1*x_1*x_3*y_2^3*y_3 + R_2*x_1^3*x_3*y_2*y_3 + R_3*x_1^3*x_2*y_2*y_3 + 2*R_1^3*x_2*x_3*y_2*y_3 - R_1*R_2^2*x_1*x_3*y_2*y_3 - R_1*R_3^2*x_1*x_2*y_2*y_3 - R_1^2*R_2*x_1*x_3*y_2*y_3 - R_1^2*R_3*x_1*x_2*y_2*y_3 + R_1*x_1*x_2*x_3^2*y_2*y_3 + R_1*x_1*x_2^2*x_3*y_2*y_3 - 2*R_1*x_1^2*x_2*x_3*y_2*y_3 + R_1*x_1*x_2*y_2*y_3*z_3^2)/(2*(R_1^2*x_2^2*y_3^2 + R_1^2*x_2^2*z_3^2 - 2*R_1^2*x_2*x_3*y_2*y_3 + R_1^2*x_3^2*y_2^2 + R_1^2*y_2^2*z_3^2 - 2*R_1*R_2*x_1*x_2*y_3^2 - 2*R_1*R_2*x_1*x_2*z_3^2 + 2*R_1*R_2*x_1*x_3*y_2*y_3 + 2*R_1*R_3*x_1*x_2*y_2*y_3 - 2*R_1*R_3*x_1*x_3*y_2^2 + R_2^2*x_1^2*y_3^2 + R_2^2*x_1^2*z_3^2 - 2*R_2*R_3*x_1^2*y_2*y_3 + R_3^2*x_1^2*y_2^2 - x_1^2*y_2^2*z_3^2))
% R2 = @(R_1,R_2,R_3) -(R_1^3*x_2^2*y_3^2 + R_1^3*x_3^2*y_2^2 + R_2^3*x_1^2*y_3^2 + R_3^3*x_1^2*y_2^2 + R_1^3*x_2^2*z_3^2 + R_2^3*x_1^2*z_3^2 + R_1^3*y_2^2*z_3^2 - R_1*x_1^2*x_2^2*y_3^2 - R_1*x_1^2*x_3^2*y_2^2 - R_2*x_1^2*x_2^2*y_3^2 - R_3*x_1^2*x_3^2*y_2^2 - R_1*x_1^2*x_2^2*z_3^2 - R_2*x_1^2*x_2^2*z_3^2 - R_2*x_1^2*y_2^2*y_3^2 - R_3*x_1^2*y_2^2*y_3^2 - R_1*x_1^2*y_2^2*z_3^2 - R_2*x_1^2*y_2^2*z_3^2 - R_3*x_1^2*y_2^2*z_3^2 + x_1*y_2*z_3*(2*R_1^4*R_2*R_3*x_2*x_3 - R_1^4*R_2^2*y_3^2 - R_1^4*R_2^2*z_3^2 - R_1^4*R_2^2*x_3^2 + 2*R_1^4*R_2*R_3*y_2*y_3 - R_1^4*R_3^2*x_2^2 - R_1^4*R_3^2*y_2^2 + R_1^4*x_2^2*y_3^2 + R_1^4*x_2^2*z_3^2 - 2*R_1^4*x_2*x_3*y_2*y_3 + R_1^4*x_3^2*y_2^2 + R_1^4*y_2^2*z_3^2 + 2*R_1^3*R_2^3*x_3^2 + 2*R_1^3*R_2^3*y_3^2 + 2*R_1^3*R_2^3*z_3^2 - 2*R_1^3*R_2^2*R_3*x_2*x_3 - 2*R_1^3*R_2^2*R_3*y_2*y_3 - 2*R_1^3*R_2*R_3^2*x_2*x_3 - 2*R_1^3*R_2*R_3^2*y_2*y_3 - 2*R_1^3*R_2*x_2^2*x_3^2 - 2*R_1^3*R_2*x_2^2*y_3^2 - 2*R_1^3*R_2*x_2^2*z_3^2 + 2*R_1^3*R_2*x_2*x_3^3 + 2*R_1^3*R_2*x_2*x_3*y_3^2 + 2*R_1^3*R_2*x_2*x_3*z_3^2 - 2*R_1^3*R_2*x_3^2*y_2^2 + 2*R_1^3*R_2*x_3^2*y_2*y_3 - 2*R_1^3*R_2*y_2^2*y_3^2 - 2*R_1^3*R_2*y_2^2*z_3^2 + 2*R_1^3*R_2*y_2*y_3^3 + 2*R_1^3*R_2*y_2*y_3*z_3^2 + 2*R_1^3*R_3^3*x_2^2 + 2*R_1^3*R_3^3*y_2^2 + 2*R_1^3*R_3*x_2^3*x_3 - 2*R_1^3*R_3*x_2^2*x_3^2 + 2*R_1^3*R_3*x_2^2*y_2*y_3 - 2*R_1^3*R_3*x_2^2*y_3^2 - 2*R_1^3*R_3*x_2^2*z_3^2 + 2*R_1^3*R_3*x_2*x_3*y_2^2 - 2*R_1^3*R_3*x_3^2*y_2^2 + 2*R_1^3*R_3*y_2^3*y_3 - 2*R_1^3*R_3*y_2^2*y_3^2 - 2*R_1^3*R_3*y_2^2*z_3^2 - R_1^2*R_2^4*x_3^2 - R_1^2*R_2^4*y_3^2 - R_1^2*R_2^4*z_3^2 - 2*R_1^2*R_2^3*R_3*x_1*x_3 + 2*R_1^2*R_2^2*R_3^2*x_1*x_2 + 2*R_1^2*R_2^2*R_3^2*x_1*x_3 + 2*R_1^2*R_2^2*R_3^2*x_2*x_3 + 2*R_1^2*R_2^2*R_3^2*y_2*y_3 + 2*R_1^2*R_2^2*x_1^2*x_3^2 + 2*R_1^2*R_2^2*x_1^2*y_3^2 + 2*R_1^2*R_2^2*x_1^2*z_3^2 - 2*R_1^2*R_2^2*x_1*x_2*y_3^2 - 2*R_1^2*R_2^2*x_1*x_2*z_3^2 - 2*R_1^2*R_2^2*x_1*x_3^3 + 2*R_1^2*R_2^2*x_1*x_3*y_2*y_3 - 2*R_1^2*R_2^2*x_1*x_3*y_3^2 - 2*R_1^2*R_2^2*x_1*x_3*z_3^2 + 2*R_1^2*R_2^2*x_2^2*x_3^2 + 2*R_1^2*R_2^2*x_2^2*y_3^2 + 2*R_1^2*R_2^2*x_2^2*z_3^2 - 2*R_1^2*R_2^2*x_2*x_3^3 - 2*R_1^2*R_2^2*x_2*x_3*y_3^2 - 2*R_1^2*R_2^2*x_2*x_3*z_3^2 + 2*R_1^2*R_2^2*x_3^2*y_2^2 - 2*R_1^2*R_2^2*x_3^2*y_2*y_3 + 2*R_1^2*R_2^2*y_2^2*y_3^2 + 2*R_1^2*R_2^2*y_2^2*z_3^2 - 2*R_1^2*R_2^2*y_2*y_3^3 - 2*R_1^2*R_2^2*y_2*y_3*z_3^2 - 2*R_1^2*R_2*R_3^3*x_1*x_2 - 4*R_1^2*R_2*R_3*x_1^2*x_2*x_3 - 4*R_1^2*R_2*R_3*x_1^2*y_2*y_3 + 2*R_1^2*R_2*R_3*x_1*x_2^2*x_3 + 2*R_1^2*R_2*R_3*x_1*x_2*x_3^2 + 2*R_1^2*R_2*R_3*x_1*x_2*y_3^2 + 2*R_1^2*R_2*R_3*x_1*x_2*z_3^2 + 2*R_1^2*R_2*R_3*x_1*x_3*y_2^2 - R_1^2*R_3^4*x_2^2 - R_1^2*R_3^4*y_2^2 + 2*R_1^2*R_3^2*x_1^2*x_2^2 + 2*R_1^2*R_3^2*x_1^2*y_2^2 - 2*R_1^2*R_3^2*x_1*x_2^3 - 2*R_1^2*R_3^2*x_1*x_2*y_2^2 + 2*R_1^2*R_3^2*x_1*x_2*y_2*y_3 - 2*R_1^2*R_3^2*x_1*x_3*y_2^2 - 2*R_1^2*R_3^2*x_2^3*x_3 + 2*R_1^2*R_3^2*x_2^2*x_3^2 - 2*R_1^2*R_3^2*x_2^2*y_2*y_3 + 2*R_1^2*R_3^2*x_2^2*y_3^2 + 2*R_1^2*R_3^2*x_2^2*z_3^2 - 2*R_1^2*R_3^2*x_2*x_3*y_2^2 + 2*R_1^2*R_3^2*x_3^2*y_2^2 - 2*R_1^2*R_3^2*y_2^3*y_3 + 2*R_1^2*R_3^2*y_2^2*y_3^2 + 2*R_1^2*R_3^2*y_2^2*z_3^2 - 2*R_1^2*x_1^2*x_2^2*y_3^2 - 2*R_1^2*x_1^2*x_2^2*z_3^2 + 4*R_1^2*x_1^2*x_2*x_3*y_2*y_3 - 2*R_1^2*x_1^2*x_3^2*y_2^2 - 2*R_1^2*x_1^2*y_2^2*z_3^2 + 2*R_1^2*x_1*x_2^3*y_3^2 + 2*R_1^2*x_1*x_2^3*z_3^2 - 2*R_1^2*x_1*x_2^2*x_3*y_2*y_3 - 2*R_1^2*x_1*x_2*x_3^2*y_2*y_3 + 2*R_1^2*x_1*x_2*y_2^2*y_3^2 + 2*R_1^2*x_1*x_2*y_2^2*z_3^2 - 2*R_1^2*x_1*x_2*y_2*y_3^3 - 2*R_1^2*x_1*x_2*y_2*y_3*z_3^2 + 2*R_1^2*x_1*x_3^3*y_2^2 - 2*R_1^2*x_1*x_3*y_2^3*y_3 + 2*R_1^2*x_1*x_3*y_2^2*y_3^2 + 2*R_1^2*x_1*x_3*y_2^2*z_3^2 - R_1^2*x_2^4*x_3^2 - R_1^2*x_2^4*y_3^2 - R_1^2*x_2^4*z_3^2 + 2*R_1^2*x_2^3*x_3^3 + 2*R_1^2*x_2^3*x_3*y_3^2 + 2*R_1^2*x_2^3*x_3*z_3^2 - R_1^2*x_2^2*x_3^4 - 2*R_1^2*x_2^2*x_3^2*y_2^2 + 2*R_1^2*x_2^2*x_3^2*y_2*y_3 - 2*R_1^2*x_2^2*x_3^2*y_3^2 - 2*R_1^2*x_2^2*x_3^2*z_3^2 - 2*R_1^2*x_2^2*y_2^2*y_3^2 - 2*R_1^2*x_2^2*y_2^2*z_3^2 + 2*R_1^2*x_2^2*y_2*y_3^3 + 2*R_1^2*x_2^2*y_2*y_3*z_3^2 - R_1^2*x_2^2*y_3^4 - 2*R_1^2*x_2^2*y_3^2*z_3^2 - R_1^2*x_2^2*z_3^4 + 2*R_1^2*x_2*x_3^3*y_2^2 + 2*R_1^2*x_2*x_3*y_2^2*y_3^2 + 2*R_1^2*x_2*x_3*y_2^2*z_3^2 - R_1^2*x_3^4*y_2^2 - R_1^2*x_3^2*y_2^4 + 2*R_1^2*x_3^2*y_2^3*y_3 - 2*R_1^2*x_3^2*y_2^2*y_3^2 - 2*R_1^2*x_3^2*y_2^2*z_3^2 - R_1^2*y_2^4*y_3^2 - R_1^2*y_2^4*z_3^2 + 2*R_1^2*y_2^3*y_3^3 + 2*R_1^2*y_2^3*y_3*z_3^2 - R_1^2*y_2^2*y_3^4 - 2*R_1^2*y_2^2*y_3^2*z_3^2 - R_1^2*y_2^2*z_3^4 + 2*R_1*R_2^4*R_3*x_1*x_3 - 2*R_1*R_2^3*R_3^2*x_1*x_3 - 2*R_1*R_2^3*x_1^2*x_3^2 - 2*R_1*R_2^3*x_1^2*y_3^2 - 2*R_1*R_2^3*x_1^2*z_3^2 + 2*R_1*R_2^3*x_1*x_3^3 + 2*R_1*R_2^3*x_1*x_3*y_3^2 + 2*R_1*R_2^3*x_1*x_3*z_3^2 - 2*R_1*R_2^2*R_3^3*x_1*x_2 + 2*R_1*R_2^2*R_3*x_1^2*x_2*x_3 + 2*R_1*R_2^2*R_3*x_1^2*y_2*y_3 - 4*R_1*R_2^2*R_3*x_1*x_2^2*x_3 + 2*R_1*R_2^2*R_3*x_1*x_2*x_3^2 + 2*R_1*R_2^2*R_3*x_1*x_2*y_3^2 + 2*R_1*R_2^2*R_3*x_1*x_2*z_3^2 - 4*R_1*R_2^2*R_3*x_1*x_3*y_2^2 + 2*R_1*R_2*R_3^4*x_1*x_2 + 2*R_1*R_2*R_3^2*x_1^2*x_2*x_3 + 2*R_1*R_2*R_3^2*x_1^2*y_2*y_3 + 2*R_1*R_2*R_3^2*x_1*x_2^2*x_3 - 4*R_1*R_2*R_3^2*x_1*x_2*x_3^2 - 4*R_1*R_2*R_3^2*x_1*x_2*y_3^2 - 4*R_1*R_2*R_3^2*x_1*x_2*z_3^2 + 2*R_1*R_2*R_3^2*x_1*x_3*y_2^2 + 2*R_1*R_2*x_1^2*x_2^2*x_3^2 + 2*R_1*R_2*x_1^2*x_2^2*y_3^2 + 2*R_1*R_2*x_1^2*x_2^2*z_3^2 - 2*R_1*R_2*x_1^2*x_2*x_3^3 - 2*R_1*R_2*x_1^2*x_2*x_3*y_3^2 - 2*R_1*R_2*x_1^2*x_2*x_3*z_3^2 + 2*R_1*R_2*x_1^2*x_3^2*y_2^2 - 2*R_1*R_2*x_1^2*x_3^2*y_2*y_3 + 2*R_1*R_2*x_1^2*y_2^2*y_3^2 + 2*R_1*R_2*x_1^2*y_2^2*z_3^2 - 2*R_1*R_2*x_1^2*y_2*y_3^3 - 2*R_1*R_2*x_1^2*y_2*y_3*z_3^2 - 2*R_1*R_2*x_1*x_2^2*x_3^3 - 2*R_1*R_2*x_1*x_2^2*x_3*y_3^2 - 2*R_1*R_2*x_1*x_2^2*x_3*z_3^2 + 2*R_1*R_2*x_1*x_2*x_3^4 + 4*R_1*R_2*x_1*x_2*x_3^2*y_3^2 + 4*R_1*R_2*x_1*x_2*x_3^2*z_3^2 + 2*R_1*R_2*x_1*x_2*y_3^4 + 4*R_1*R_2*x_1*x_2*y_3^2*z_3^2 + 2*R_1*R_2*x_1*x_2*z_3^4 - 2*R_1*R_2*x_1*x_3^3*y_2^2 - 2*R_1*R_2*x_1*x_3*y_2^2*y_3^2 - 2*R_1*R_2*x_1*x_3*y_2^2*z_3^2 - 2*R_1*R_3^3*x_1^2*x_2^2 - 2*R_1*R_3^3*x_1^2*y_2^2 + 2*R_1*R_3^3*x_1*x_2^3 + 2*R_1*R_3^3*x_1*x_2*y_2^2 - 2*R_1*R_3*x_1^2*x_2^3*x_3 + 2*R_1*R_3*x_1^2*x_2^2*x_3^2 - 2*R_1*R_3*x_1^2*x_2^2*y_2*y_3 + 2*R_1*R_3*x_1^2*x_2^2*y_3^2 + 2*R_1*R_3*x_1^2*x_2^2*z_3^2 - 2*R_1*R_3*x_1^2*x_2*x_3*y_2^2 + 2*R_1*R_3*x_1^2*x_3^2*y_2^2 - 2*R_1*R_3*x_1^2*y_2^3*y_3 + 2*R_1*R_3*x_1^2*y_2^2*y_3^2 + 2*R_1*R_3*x_1^2*y_2^2*z_3^2 + 2*R_1*R_3*x_1*x_2^4*x_3 - 2*R_1*R_3*x_1*x_2^3*x_3^2 - 2*R_1*R_3*x_1*x_2^3*y_3^2 - 2*R_1*R_3*x_1*x_2^3*z_3^2 + 4*R_1*R_3*x_1*x_2^2*x_3*y_2^2 - 2*R_1*R_3*x_1*x_2*x_3^2*y_2^2 - 2*R_1*R_3*x_1*x_2*y_2^2*y_3^2 - 2*R_1*R_3*x_1*x_2*y_2^2*z_3^2 + 2*R_1*R_3*x_1*x_3*y_2^4 - R_2^4*R_3^2*x_1^2 + R_2^4*x_1^2*y_3^2 + R_2^4*x_1^2*z_3^2 + 2*R_2^3*R_3^3*x_1^2 + 2*R_2^3*R_3*x_1^3*x_3 - 2*R_2^3*R_3*x_1^2*x_3^2 - 2*R_2^3*R_3*x_1^2*y_3^2 - 2*R_2^3*R_3*x_1^2*z_3^2 - R_2^2*R_3^4*x_1^2 - 2*R_2^2*R_3^2*x_1^3*x_2 - 2*R_2^2*R_3^2*x_1^3*x_3 + 2*R_2^2*R_3^2*x_1^2*x_2^2 + 2*R_2^2*R_3^2*x_1^2*x_3^2 + 2*R_2^2*R_3^2*x_1^2*y_2^2 - 2*R_2^2*R_3^2*x_1^2*y_2*y_3 + 2*R_2^2*R_3^2*x_1^2*y_3^2 + 2*R_2^2*R_3^2*x_1^2*z_3^2 - R_2^2*x_1^4*x_3^2 - R_2^2*x_1^4*y_3^2 - R_2^2*x_1^4*z_3^2 + 2*R_2^2*x_1^3*x_2*y_3^2 + 2*R_2^2*x_1^3*x_2*z_3^2 + 2*R_2^2*x_1^3*x_3^3 - 2*R_2^2*x_1^3*x_3*y_2*y_3 + 2*R_2^2*x_1^3*x_3*y_3^2 + 2*R_2^2*x_1^3*x_3*z_3^2 - 2*R_2^2*x_1^2*x_2^2*y_3^2 - 2*R_2^2*x_1^2*x_2^2*z_3^2 - R_2^2*x_1^2*x_3^4 + 2*R_2^2*x_1^2*x_3^2*y_2*y_3 - 2*R_2^2*x_1^2*x_3^2*y_3^2 - 2*R_2^2*x_1^2*x_3^2*z_3^2 - 2*R_2^2*x_1^2*y_2^2*y_3^2 - 2*R_2^2*x_1^2*y_2^2*z_3^2 + 2*R_2^2*x_1^2*y_2*y_3^3 + 2*R_2^2*x_1^2*y_2*y_3*z_3^2 - R_2^2*x_1^2*y_3^4 - 2*R_2^2*x_1^2*y_3^2*z_3^2 - R_2^2*x_1^2*z_3^4 + 2*R_2*R_3^3*x_1^3*x_2 - 2*R_2*R_3^3*x_1^2*x_2^2 - 2*R_2*R_3^3*x_1^2*y_2^2 + 2*R_2*R_3*x_1^4*x_2*x_3 + 2*R_2*R_3*x_1^4*y_2*y_3 - 2*R_2*R_3*x_1^3*x_2^2*x_3 - 2*R_2*R_3*x_1^3*x_2*x_3^2 - 2*R_2*R_3*x_1^3*x_2*y_3^2 - 2*R_2*R_3*x_1^3*x_2*z_3^2 - 2*R_2*R_3*x_1^3*x_3*y_2^2 + 2*R_2*R_3*x_1^2*x_2^2*x_3^2 + 2*R_2*R_3*x_1^2*x_2^2*y_3^2 + 2*R_2*R_3*x_1^2*x_2^2*z_3^2 + 2*R_2*R_3*x_1^2*x_3^2*y_2^2 + 2*R_2*R_3*x_1^2*y_2^2*y_3^2 + 2*R_2*R_3*x_1^2*y_2^2*z_3^2 + R_3^4*x_1^2*y_2^2 - R_3^2*x_1^4*x_2^2 - R_3^2*x_1^4*y_2^2 + 2*R_3^2*x_1^3*x_2^3 + 2*R_3^2*x_1^3*x_2*y_2^2 - 2*R_3^2*x_1^3*x_2*y_2*y_3 + 2*R_3^2*x_1^3*x_3*y_2^2 - R_3^2*x_1^2*x_2^4 - 2*R_3^2*x_1^2*x_2^2*y_2^2 + 2*R_3^2*x_1^2*x_2^2*y_2*y_3 - 2*R_3^2*x_1^2*x_3^2*y_2^2 - R_3^2*x_1^2*y_2^4 + 2*R_3^2*x_1^2*y_2^3*y_3 - 2*R_3^2*x_1^2*y_2^2*y_3^2 - 2*R_3^2*x_1^2*y_2^2*z_3^2 + x_1^4*x_2^2*y_3^2 + x_1^4*x_2^2*z_3^2 - 2*x_1^4*x_2*x_3*y_2*y_3 + x_1^4*x_3^2*y_2^2 + x_1^4*y_2^2*z_3^2 - 2*x_1^3*x_2^3*y_3^2 - 2*x_1^3*x_2^3*z_3^2 + 2*x_1^3*x_2^2*x_3*y_2*y_3 + 2*x_1^3*x_2*x_3^2*y_2*y_3 - 2*x_1^3*x_2*y_2^2*y_3^2 - 2*x_1^3*x_2*y_2^2*z_3^2 + 2*x_1^3*x_2*y_2*y_3^3 + 2*x_1^3*x_2*y_2*y_3*z_3^2 - 2*x_1^3*x_3^3*y_2^2 + 2*x_1^3*x_3*y_2^3*y_3 - 2*x_1^3*x_3*y_2^2*y_3^2 - 2*x_1^3*x_3*y_2^2*z_3^2 + x_1^2*x_2^4*y_3^2 + x_1^2*x_2^4*z_3^2 - 2*x_1^2*x_2^2*x_3^2*y_2*y_3 + 2*x_1^2*x_2^2*y_2^2*y_3^2 + 2*x_1^2*x_2^2*y_2^2*z_3^2 - 2*x_1^2*x_2^2*y_2*y_3^3 - 2*x_1^2*x_2^2*y_2*y_3*z_3^2 + x_1^2*x_3^4*y_2^2 - 2*x_1^2*x_3^2*y_2^3*y_3 + 2*x_1^2*x_3^2*y_2^2*y_3^2 + 2*x_1^2*x_3^2*y_2^2*z_3^2 + x_1^2*y_2^4*y_3^2 + x_1^2*y_2^4*z_3^2 - 2*x_1^2*y_2^3*y_3^3 - 2*x_1^2*y_2^3*y_3*z_3^2 + x_1^2*y_2^2*y_3^4 + 2*x_1^2*y_2^2*y_3^2*z_3^2 + x_1^2*y_2^2*z_3^4)^(1/2) + R_1*x_1*x_2^3*y_3^2 + R_1*x_1*x_3^3*y_2^2 + R_2*x_1^3*x_2*y_3^2 + R_3*x_1^3*x_3*y_2^2 + R_1*x_1*x_2^3*z_3^2 + R_2*x_1^2*y_2*y_3^3 + R_2*x_1^3*x_2*z_3^2 + R_3*x_1^2*y_2^3*y_3 - R_1*R_2^2*x_1*x_2*y_3^2 - R_1^2*R_2*x_1*x_2*y_3^2 - R_1*R_3^2*x_1*x_3*y_2^2 - R_1^2*R_3*x_1*x_3*y_2^2 - R_1*R_2^2*x_1*x_2*z_3^2 - R_1^2*R_2*x_1*x_2*z_3^2 - R_2*R_3^2*x_1^2*y_2*y_3 - R_2^2*R_3*x_1^2*y_2*y_3 + R_1*x_1*x_2*y_2^2*y_3^2 + R_1*x_1*x_3*y_2^2*y_3^2 + R_2*x_1^2*x_3^2*y_2*y_3 + R_3*x_1^2*x_2^2*y_2*y_3 + R_1*x_1*x_2*y_2^2*z_3^2 + R_1*x_1*x_3*y_2^2*z_3^2 + R_2*x_1^2*y_2*y_3*z_3^2 - R_1*x_1*x_2*y_2*y_3^3 - R_1*x_1*x_3*y_2^3*y_3 - R_2*x_1^3*x_3*y_2*y_3 - R_3*x_1^3*x_2*y_2*y_3 - 2*R_1^3*x_2*x_3*y_2*y_3 + R_1*R_2^2*x_1*x_3*y_2*y_3 + R_1*R_3^2*x_1*x_2*y_2*y_3 + R_1^2*R_2*x_1*x_3*y_2*y_3 + R_1^2*R_3*x_1*x_2*y_2*y_3 - R_1*x_1*x_2*x_3^2*y_2*y_3 - R_1*x_1*x_2^2*x_3*y_2*y_3 + 2*R_1*x_1^2*x_2*x_3*y_2*y_3 - R_1*x_1*x_2*y_2*y_3*z_3^2)/(2*(R_1^2*x_2^2*y_3^2 + R_1^2*x_2^2*z_3^2 - 2*R_1^2*x_2*x_3*y_2*y_3 + R_1^2*x_3^2*y_2^2 + R_1^2*y_2^2*z_3^2 - 2*R_1*R_2*x_1*x_2*y_3^2 - 2*R_1*R_2*x_1*x_2*z_3^2 + 2*R_1*R_2*x_1*x_3*y_2*y_3 + 2*R_1*R_3*x_1*x_2*y_2*y_3 - 2*R_1*R_3*x_1*x_3*y_2^2 + R_2^2*x_1^2*y_3^2 + R_2^2*x_1^2*z_3^2 - 2*R_2*R_3*x_1^2*y_2*y_3 + R_3^2*x_1^2*y_2^2 - x_1^2*y_2^2*z_3^2))

% R1 = @(R_1,R_2,R_3) (R_1.*x_1.^2.*x_2.^2.*y_3.^2 - R_1.^3.*x_3.^2.*y_2.^2 - R_2.^3.*x_1.^2.*y_3.^2 - R_3.^3.*x_1.^2.*y_2.^2 - R_1.^3.*x_2.^2.*z_3.^2 - R_2.^3.*x_1.^2.*z_3.^2 - R_1.^3.*y_2.^2.*z_3.^2 - R_1.^3.*x_2.^2.*y_3.^2 + R_1.*x_1.^2.*x_3.^2.*y_2.^2 + R_2.*x_1.^2.*x_2.^2.*y_3.^2 + R_3.*x_1.^2.*x_3.^2.*y_2.^2 + R_1.*x_1.^2.*x_2.^2.*z_3.^2 + R_2.*x_1.^2.*x_2.^2.*z_3.^2 + R_2.*x_1.^2.*y_2.^2.*y_3.^2 + R_3.*x_1.^2.*y_2.^2.*y_3.^2 + R_1.*x_1.^2.*y_2.^2.*z_3.^2 + R_2.*x_1.^2.*y_2.^2.*z_3.^2 + R_3.*x_1.^2.*y_2.^2.*z_3.^2 + x_1.*y_2.*z_3.*(2.*R_1.^4.*R_2.*R_3.*x_2.*x_3 - R_1.^4.*R_2.^2.*y_3.^2 - R_1.^4.*R_2.^2.*z_3.^2 - R_1.^4.*R_2.^2.*x_3.^2 + 2.*R_1.^4.*R_2.*R_3.*y_2.*y_3 - R_1.^4.*R_3.^2.*x_2.^2 - R_1.^4.*R_3.^2.*y_2.^2 + R_1.^4.*x_2.^2.*y_3.^2 + R_1.^4.*x_2.^2.*z_3.^2 - 2.*R_1.^4.*x_2.*x_3.*y_2.*y_3 + R_1.^4.*x_3.^2.*y_2.^2 + R_1.^4.*y_2.^2.*z_3.^2 + 2.*R_1.^3.*R_2.^3.*x_3.^2 + 2.*R_1.^3.*R_2.^3.*y_3.^2 + 2.*R_1.^3.*R_2.^3.*z_3.^2 - 2.*R_1.^3.*R_2.^2.*R_3.*x_2.*x_3 - 2.*R_1.^3.*R_2.^2.*R_3.*y_2.*y_3 - 2.*R_1.^3.*R_2.*R_3.^2.*x_2.*x_3 - 2.*R_1.^3.*R_2.*R_3.^2.*y_2.*y_3 - 2.*R_1.^3.*R_2.*x_2.^2.*x_3.^2 - 2.*R_1.^3.*R_2.*x_2.^2.*y_3.^2 - 2.*R_1.^3.*R_2.*x_2.^2.*z_3.^2 + 2.*R_1.^3.*R_2.*x_2.*x_3.^3 + 2.*R_1.^3.*R_2.*x_2.*x_3.*y_3.^2 + 2.*R_1.^3.*R_2.*x_2.*x_3.*z_3.^2 - 2.*R_1.^3.*R_2.*x_3.^2.*y_2.^2 + 2.*R_1.^3.*R_2.*x_3.^2.*y_2.*y_3 - 2.*R_1.^3.*R_2.*y_2.^2.*y_3.^2 - 2.*R_1.^3.*R_2.*y_2.^2.*z_3.^2 + 2.*R_1.^3.*R_2.*y_2.*y_3.^3 + 2.*R_1.^3.*R_2.*y_2.*y_3.*z_3.^2 + 2.*R_1.^3.*R_3.^3.*x_2.^2 + 2.*R_1.^3.*R_3.^3.*y_2.^2 + 2.*R_1.^3.*R_3.*x_2.^3.*x_3 - 2.*R_1.^3.*R_3.*x_2.^2.*x_3.^2 + 2.*R_1.^3.*R_3.*x_2.^2.*y_2.*y_3 - 2.*R_1.^3.*R_3.*x_2.^2.*y_3.^2 - 2.*R_1.^3.*R_3.*x_2.^2.*z_3.^2 + 2.*R_1.^3.*R_3.*x_2.*x_3.*y_2.^2 - 2.*R_1.^3.*R_3.*x_3.^2.*y_2.^2 + 2.*R_1.^3.*R_3.*y_2.^3.*y_3 - 2.*R_1.^3.*R_3.*y_2.^2.*y_3.^2 - 2.*R_1.^3.*R_3.*y_2.^2.*z_3.^2 - R_1.^2.*R_2.^4.*x_3.^2 - R_1.^2.*R_2.^4.*y_3.^2 - R_1.^2.*R_2.^4.*z_3.^2 - 2.*R_1.^2.*R_2.^3.*R_3.*x_1.*x_3 + 2.*R_1.^2.*R_2.^2.*R_3.^2.*x_1.*x_2 + 2.*R_1.^2.*R_2.^2.*R_3.^2.*x_1.*x_3 + 2.*R_1.^2.*R_2.^2.*R_3.^2.*x_2.*x_3 + 2.*R_1.^2.*R_2.^2.*R_3.^2.*y_2.*y_3 + 2.*R_1.^2.*R_2.^2.*x_1.^2.*x_3.^2 + 2.*R_1.^2.*R_2.^2.*x_1.^2.*y_3.^2 + 2.*R_1.^2.*R_2.^2.*x_1.^2.*z_3.^2 - 2.*R_1.^2.*R_2.^2.*x_1.*x_2.*y_3.^2 - 2.*R_1.^2.*R_2.^2.*x_1.*x_2.*z_3.^2 - 2.*R_1.^2.*R_2.^2.*x_1.*x_3.^3 + 2.*R_1.^2.*R_2.^2.*x_1.*x_3.*y_2.*y_3 - 2.*R_1.^2.*R_2.^2.*x_1.*x_3.*y_3.^2 - 2.*R_1.^2.*R_2.^2.*x_1.*x_3.*z_3.^2 + 2.*R_1.^2.*R_2.^2.*x_2.^2.*x_3.^2 + 2.*R_1.^2.*R_2.^2.*x_2.^2.*y_3.^2 + 2.*R_1.^2.*R_2.^2.*x_2.^2.*z_3.^2 - 2.*R_1.^2.*R_2.^2.*x_2.*x_3.^3 - 2.*R_1.^2.*R_2.^2.*x_2.*x_3.*y_3.^2 - 2.*R_1.^2.*R_2.^2.*x_2.*x_3.*z_3.^2 + 2.*R_1.^2.*R_2.^2.*x_3.^2.*y_2.^2 - 2.*R_1.^2.*R_2.^2.*x_3.^2.*y_2.*y_3 + 2.*R_1.^2.*R_2.^2.*y_2.^2.*y_3.^2 + 2.*R_1.^2.*R_2.^2.*y_2.^2.*z_3.^2 - 2.*R_1.^2.*R_2.^2.*y_2.*y_3.^3 - 2.*R_1.^2.*R_2.^2.*y_2.*y_3.*z_3.^2 - 2.*R_1.^2.*R_2.*R_3.^3.*x_1.*x_2 - 4.*R_1.^2.*R_2.*R_3.*x_1.^2.*x_2.*x_3 - 4.*R_1.^2.*R_2.*R_3.*x_1.^2.*y_2.*y_3 + 2.*R_1.^2.*R_2.*R_3.*x_1.*x_2.^2.*x_3 + 2.*R_1.^2.*R_2.*R_3.*x_1.*x_2.*x_3.^2 + 2.*R_1.^2.*R_2.*R_3.*x_1.*x_2.*y_3.^2 + 2.*R_1.^2.*R_2.*R_3.*x_1.*x_2.*z_3.^2 + 2.*R_1.^2.*R_2.*R_3.*x_1.*x_3.*y_2.^2 - R_1.^2.*R_3.^4.*x_2.^2 - R_1.^2.*R_3.^4.*y_2.^2 + 2.*R_1.^2.*R_3.^2.*x_1.^2.*x_2.^2 + 2.*R_1.^2.*R_3.^2.*x_1.^2.*y_2.^2 - 2.*R_1.^2.*R_3.^2.*x_1.*x_2.^3 - 2.*R_1.^2.*R_3.^2.*x_1.*x_2.*y_2.^2 + 2.*R_1.^2.*R_3.^2.*x_1.*x_2.*y_2.*y_3 - 2.*R_1.^2.*R_3.^2.*x_1.*x_3.*y_2.^2 - 2.*R_1.^2.*R_3.^2.*x_2.^3.*x_3 + 2.*R_1.^2.*R_3.^2.*x_2.^2.*x_3.^2 - 2.*R_1.^2.*R_3.^2.*x_2.^2.*y_2.*y_3 + 2.*R_1.^2.*R_3.^2.*x_2.^2.*y_3.^2 + 2.*R_1.^2.*R_3.^2.*x_2.^2.*z_3.^2 - 2.*R_1.^2.*R_3.^2.*x_2.*x_3.*y_2.^2 + 2.*R_1.^2.*R_3.^2.*x_3.^2.*y_2.^2 - 2.*R_1.^2.*R_3.^2.*y_2.^3.*y_3 + 2.*R_1.^2.*R_3.^2.*y_2.^2.*y_3.^2 + 2.*R_1.^2.*R_3.^2.*y_2.^2.*z_3.^2 - 2.*R_1.^2.*x_1.^2.*x_2.^2.*y_3.^2 - 2.*R_1.^2.*x_1.^2.*x_2.^2.*z_3.^2 + 4.*R_1.^2.*x_1.^2.*x_2.*x_3.*y_2.*y_3 - 2.*R_1.^2.*x_1.^2.*x_3.^2.*y_2.^2 - 2.*R_1.^2.*x_1.^2.*y_2.^2.*z_3.^2 + 2.*R_1.^2.*x_1.*x_2.^3.*y_3.^2 + 2.*R_1.^2.*x_1.*x_2.^3.*z_3.^2 - 2.*R_1.^2.*x_1.*x_2.^2.*x_3.*y_2.*y_3 - 2.*R_1.^2.*x_1.*x_2.*x_3.^2.*y_2.*y_3 + 2.*R_1.^2.*x_1.*x_2.*y_2.^2.*y_3.^2 + 2.*R_1.^2.*x_1.*x_2.*y_2.^2.*z_3.^2 - 2.*R_1.^2.*x_1.*x_2.*y_2.*y_3.^3 - 2.*R_1.^2.*x_1.*x_2.*y_2.*y_3.*z_3.^2 + 2.*R_1.^2.*x_1.*x_3.^3.*y_2.^2 - 2.*R_1.^2.*x_1.*x_3.*y_2.^3.*y_3 + 2.*R_1.^2.*x_1.*x_3.*y_2.^2.*y_3.^2 + 2.*R_1.^2.*x_1.*x_3.*y_2.^2.*z_3.^2 - R_1.^2.*x_2.^4.*x_3.^2 - R_1.^2.*x_2.^4.*y_3.^2 - R_1.^2.*x_2.^4.*z_3.^2 + 2.*R_1.^2.*x_2.^3.*x_3.^3 + 2.*R_1.^2.*x_2.^3.*x_3.*y_3.^2 + 2.*R_1.^2.*x_2.^3.*x_3.*z_3.^2 - R_1.^2.*x_2.^2.*x_3.^4 - 2.*R_1.^2.*x_2.^2.*x_3.^2.*y_2.^2 + 2.*R_1.^2.*x_2.^2.*x_3.^2.*y_2.*y_3 - 2.*R_1.^2.*x_2.^2.*x_3.^2.*y_3.^2 - 2.*R_1.^2.*x_2.^2.*x_3.^2.*z_3.^2 - 2.*R_1.^2.*x_2.^2.*y_2.^2.*y_3.^2 - 2.*R_1.^2.*x_2.^2.*y_2.^2.*z_3.^2 + 2.*R_1.^2.*x_2.^2.*y_2.*y_3.^3 + 2.*R_1.^2.*x_2.^2.*y_2.*y_3.*z_3.^2 - R_1.^2.*x_2.^2.*y_3.^4 - 2.*R_1.^2.*x_2.^2.*y_3.^2.*z_3.^2 - R_1.^2.*x_2.^2.*z_3.^4 + 2.*R_1.^2.*x_2.*x_3.^3.*y_2.^2 + 2.*R_1.^2.*x_2.*x_3.*y_2.^2.*y_3.^2 + 2.*R_1.^2.*x_2.*x_3.*y_2.^2.*z_3.^2 - R_1.^2.*x_3.^4.*y_2.^2 - R_1.^2.*x_3.^2.*y_2.^4 + 2.*R_1.^2.*x_3.^2.*y_2.^3.*y_3 - 2.*R_1.^2.*x_3.^2.*y_2.^2.*y_3.^2 - 2.*R_1.^2.*x_3.^2.*y_2.^2.*z_3.^2 - R_1.^2.*y_2.^4.*y_3.^2 - R_1.^2.*y_2.^4.*z_3.^2 + 2.*R_1.^2.*y_2.^3.*y_3.^3 + 2.*R_1.^2.*y_2.^3.*y_3.*z_3.^2 - R_1.^2.*y_2.^2.*y_3.^4 - 2.*R_1.^2.*y_2.^2.*y_3.^2.*z_3.^2 - R_1.^2.*y_2.^2.*z_3.^4 + 2.*R_1.*R_2.^4.*R_3.*x_1.*x_3 - 2.*R_1.*R_2.^3.*R_3.^2.*x_1.*x_3 - 2.*R_1.*R_2.^3.*x_1.^2.*x_3.^2 - 2.*R_1.*R_2.^3.*x_1.^2.*y_3.^2 - 2.*R_1.*R_2.^3.*x_1.^2.*z_3.^2 + 2.*R_1.*R_2.^3.*x_1.*x_3.^3 + 2.*R_1.*R_2.^3.*x_1.*x_3.*y_3.^2 + 2.*R_1.*R_2.^3.*x_1.*x_3.*z_3.^2 - 2.*R_1.*R_2.^2.*R_3.^3.*x_1.*x_2 + 2.*R_1.*R_2.^2.*R_3.*x_1.^2.*x_2.*x_3 + 2.*R_1.*R_2.^2.*R_3.*x_1.^2.*y_2.*y_3 - 4.*R_1.*R_2.^2.*R_3.*x_1.*x_2.^2.*x_3 + 2.*R_1.*R_2.^2.*R_3.*x_1.*x_2.*x_3.^2 + 2.*R_1.*R_2.^2.*R_3.*x_1.*x_2.*y_3.^2 + 2.*R_1.*R_2.^2.*R_3.*x_1.*x_2.*z_3.^2 - 4.*R_1.*R_2.^2.*R_3.*x_1.*x_3.*y_2.^2 + 2.*R_1.*R_2.*R_3.^4.*x_1.*x_2 + 2.*R_1.*R_2.*R_3.^2.*x_1.^2.*x_2.*x_3 + 2.*R_1.*R_2.*R_3.^2.*x_1.^2.*y_2.*y_3 + 2.*R_1.*R_2.*R_3.^2.*x_1.*x_2.^2.*x_3 - 4.*R_1.*R_2.*R_3.^2.*x_1.*x_2.*x_3.^2 - 4.*R_1.*R_2.*R_3.^2.*x_1.*x_2.*y_3.^2 - 4.*R_1.*R_2.*R_3.^2.*x_1.*x_2.*z_3.^2 + 2.*R_1.*R_2.*R_3.^2.*x_1.*x_3.*y_2.^2 + 2.*R_1.*R_2.*x_1.^2.*x_2.^2.*x_3.^2 + 2.*R_1.*R_2.*x_1.^2.*x_2.^2.*y_3.^2 + 2.*R_1.*R_2.*x_1.^2.*x_2.^2.*z_3.^2 - 2.*R_1.*R_2.*x_1.^2.*x_2.*x_3.^3 - 2.*R_1.*R_2.*x_1.^2.*x_2.*x_3.*y_3.^2 - 2.*R_1.*R_2.*x_1.^2.*x_2.*x_3.*z_3.^2 + 2.*R_1.*R_2.*x_1.^2.*x_3.^2.*y_2.^2 - 2.*R_1.*R_2.*x_1.^2.*x_3.^2.*y_2.*y_3 + 2.*R_1.*R_2.*x_1.^2.*y_2.^2.*y_3.^2 + 2.*R_1.*R_2.*x_1.^2.*y_2.^2.*z_3.^2 - 2.*R_1.*R_2.*x_1.^2.*y_2.*y_3.^3 - 2.*R_1.*R_2.*x_1.^2.*y_2.*y_3.*z_3.^2 - 2.*R_1.*R_2.*x_1.*x_2.^2.*x_3.^3 - 2.*R_1.*R_2.*x_1.*x_2.^2.*x_3.*y_3.^2 - 2.*R_1.*R_2.*x_1.*x_2.^2.*x_3.*z_3.^2 + 2.*R_1.*R_2.*x_1.*x_2.*x_3.^4 + 4.*R_1.*R_2.*x_1.*x_2.*x_3.^2.*y_3.^2 + 4.*R_1.*R_2.*x_1.*x_2.*x_3.^2.*z_3.^2 + 2.*R_1.*R_2.*x_1.*x_2.*y_3.^4 + 4.*R_1.*R_2.*x_1.*x_2.*y_3.^2.*z_3.^2 + 2.*R_1.*R_2.*x_1.*x_2.*z_3.^4 - 2.*R_1.*R_2.*x_1.*x_3.^3.*y_2.^2 - 2.*R_1.*R_2.*x_1.*x_3.*y_2.^2.*y_3.^2 - 2.*R_1.*R_2.*x_1.*x_3.*y_2.^2.*z_3.^2 - 2.*R_1.*R_3.^3.*x_1.^2.*x_2.^2 - 2.*R_1.*R_3.^3.*x_1.^2.*y_2.^2 + 2.*R_1.*R_3.^3.*x_1.*x_2.^3 + 2.*R_1.*R_3.^3.*x_1.*x_2.*y_2.^2 - 2.*R_1.*R_3.*x_1.^2.*x_2.^3.*x_3 + 2.*R_1.*R_3.*x_1.^2.*x_2.^2.*x_3.^2 - 2.*R_1.*R_3.*x_1.^2.*x_2.^2.*y_2.*y_3 + 2.*R_1.*R_3.*x_1.^2.*x_2.^2.*y_3.^2 + 2.*R_1.*R_3.*x_1.^2.*x_2.^2.*z_3.^2 - 2.*R_1.*R_3.*x_1.^2.*x_2.*x_3.*y_2.^2 + 2.*R_1.*R_3.*x_1.^2.*x_3.^2.*y_2.^2 - 2.*R_1.*R_3.*x_1.^2.*y_2.^3.*y_3 + 2.*R_1.*R_3.*x_1.^2.*y_2.^2.*y_3.^2 + 2.*R_1.*R_3.*x_1.^2.*y_2.^2.*z_3.^2 + 2.*R_1.*R_3.*x_1.*x_2.^4.*x_3 - 2.*R_1.*R_3.*x_1.*x_2.^3.*x_3.^2 - 2.*R_1.*R_3.*x_1.*x_2.^3.*y_3.^2 - 2.*R_1.*R_3.*x_1.*x_2.^3.*z_3.^2 + 4.*R_1.*R_3.*x_1.*x_2.^2.*x_3.*y_2.^2 - 2.*R_1.*R_3.*x_1.*x_2.*x_3.^2.*y_2.^2 - 2.*R_1.*R_3.*x_1.*x_2.*y_2.^2.*y_3.^2 - 2.*R_1.*R_3.*x_1.*x_2.*y_2.^2.*z_3.^2 + 2.*R_1.*R_3.*x_1.*x_3.*y_2.^4 - R_2.^4.*R_3.^2.*x_1.^2 + R_2.^4.*x_1.^2.*y_3.^2 + R_2.^4.*x_1.^2.*z_3.^2 + 2.*R_2.^3.*R_3.^3.*x_1.^2 + 2.*R_2.^3.*R_3.*x_1.^3.*x_3 - 2.*R_2.^3.*R_3.*x_1.^2.*x_3.^2 - 2.*R_2.^3.*R_3.*x_1.^2.*y_3.^2 - 2.*R_2.^3.*R_3.*x_1.^2.*z_3.^2 - R_2.^2.*R_3.^4.*x_1.^2 - 2.*R_2.^2.*R_3.^2.*x_1.^3.*x_2 - 2.*R_2.^2.*R_3.^2.*x_1.^3.*x_3 + 2.*R_2.^2.*R_3.^2.*x_1.^2.*x_2.^2 + 2.*R_2.^2.*R_3.^2.*x_1.^2.*x_3.^2 + 2.*R_2.^2.*R_3.^2.*x_1.^2.*y_2.^2 - 2.*R_2.^2.*R_3.^2.*x_1.^2.*y_2.*y_3 + 2.*R_2.^2.*R_3.^2.*x_1.^2.*y_3.^2 + 2.*R_2.^2.*R_3.^2.*x_1.^2.*z_3.^2 - R_2.^2.*x_1.^4.*x_3.^2 - R_2.^2.*x_1.^4.*y_3.^2 - R_2.^2.*x_1.^4.*z_3.^2 + 2.*R_2.^2.*x_1.^3.*x_2.*y_3.^2 + 2.*R_2.^2.*x_1.^3.*x_2.*z_3.^2 + 2.*R_2.^2.*x_1.^3.*x_3.^3 - 2.*R_2.^2.*x_1.^3.*x_3.*y_2.*y_3 + 2.*R_2.^2.*x_1.^3.*x_3.*y_3.^2 + 2.*R_2.^2.*x_1.^3.*x_3.*z_3.^2 - 2.*R_2.^2.*x_1.^2.*x_2.^2.*y_3.^2 - 2.*R_2.^2.*x_1.^2.*x_2.^2.*z_3.^2 - R_2.^2.*x_1.^2.*x_3.^4 + 2.*R_2.^2.*x_1.^2.*x_3.^2.*y_2.*y_3 - 2.*R_2.^2.*x_1.^2.*x_3.^2.*y_3.^2 - 2.*R_2.^2.*x_1.^2.*x_3.^2.*z_3.^2 - 2.*R_2.^2.*x_1.^2.*y_2.^2.*y_3.^2 - 2.*R_2.^2.*x_1.^2.*y_2.^2.*z_3.^2 + 2.*R_2.^2.*x_1.^2.*y_2.*y_3.^3 + 2.*R_2.^2.*x_1.^2.*y_2.*y_3.*z_3.^2 - R_2.^2.*x_1.^2.*y_3.^4 - 2.*R_2.^2.*x_1.^2.*y_3.^2.*z_3.^2 - R_2.^2.*x_1.^2.*z_3.^4 + 2.*R_2.*R_3.^3.*x_1.^3.*x_2 - 2.*R_2.*R_3.^3.*x_1.^2.*x_2.^2 - 2.*R_2.*R_3.^3.*x_1.^2.*y_2.^2 + 2.*R_2.*R_3.*x_1.^4.*x_2.*x_3 + 2.*R_2.*R_3.*x_1.^4.*y_2.*y_3 - 2.*R_2.*R_3.*x_1.^3.*x_2.^2.*x_3 - 2.*R_2.*R_3.*x_1.^3.*x_2.*x_3.^2 - 2.*R_2.*R_3.*x_1.^3.*x_2.*y_3.^2 - 2.*R_2.*R_3.*x_1.^3.*x_2.*z_3.^2 - 2.*R_2.*R_3.*x_1.^3.*x_3.*y_2.^2 + 2.*R_2.*R_3.*x_1.^2.*x_2.^2.*x_3.^2 + 2.*R_2.*R_3.*x_1.^2.*x_2.^2.*y_3.^2 + 2.*R_2.*R_3.*x_1.^2.*x_2.^2.*z_3.^2 + 2.*R_2.*R_3.*x_1.^2.*x_3.^2.*y_2.^2 + 2.*R_2.*R_3.*x_1.^2.*y_2.^2.*y_3.^2 + 2.*R_2.*R_3.*x_1.^2.*y_2.^2.*z_3.^2 + R_3.^4.*x_1.^2.*y_2.^2 - R_3.^2.*x_1.^4.*x_2.^2 - R_3.^2.*x_1.^4.*y_2.^2 + 2.*R_3.^2.*x_1.^3.*x_2.^3 + 2.*R_3.^2.*x_1.^3.*x_2.*y_2.^2 - 2.*R_3.^2.*x_1.^3.*x_2.*y_2.*y_3 + 2.*R_3.^2.*x_1.^3.*x_3.*y_2.^2 - R_3.^2.*x_1.^2.*x_2.^4 - 2.*R_3.^2.*x_1.^2.*x_2.^2.*y_2.^2 + 2.*R_3.^2.*x_1.^2.*x_2.^2.*y_2.*y_3 - 2.*R_3.^2.*x_1.^2.*x_3.^2.*y_2.^2 - R_3.^2.*x_1.^2.*y_2.^4 + 2.*R_3.^2.*x_1.^2.*y_2.^3.*y_3 - 2.*R_3.^2.*x_1.^2.*y_2.^2.*y_3.^2 - 2.*R_3.^2.*x_1.^2.*y_2.^2.*z_3.^2 + x_1.^4.*x_2.^2.*y_3.^2 + x_1.^4.*x_2.^2.*z_3.^2 - 2.*x_1.^4.*x_2.*x_3.*y_2.*y_3 + x_1.^4.*x_3.^2.*y_2.^2 + x_1.^4.*y_2.^2.*z_3.^2 - 2.*x_1.^3.*x_2.^3.*y_3.^2 - 2.*x_1.^3.*x_2.^3.*z_3.^2 + 2.*x_1.^3.*x_2.^2.*x_3.*y_2.*y_3 + 2.*x_1.^3.*x_2.*x_3.^2.*y_2.*y_3 - 2.*x_1.^3.*x_2.*y_2.^2.*y_3.^2 - 2.*x_1.^3.*x_2.*y_2.^2.*z_3.^2 + 2.*x_1.^3.*x_2.*y_2.*y_3.^3 + 2.*x_1.^3.*x_2.*y_2.*y_3.*z_3.^2 - 2.*x_1.^3.*x_3.^3.*y_2.^2 + 2.*x_1.^3.*x_3.*y_2.^3.*y_3 - 2.*x_1.^3.*x_3.*y_2.^2.*y_3.^2 - 2.*x_1.^3.*x_3.*y_2.^2.*z_3.^2 + x_1.^2.*x_2.^4.*y_3.^2 + x_1.^2.*x_2.^4.*z_3.^2 - 2.*x_1.^2.*x_2.^2.*x_3.^2.*y_2.*y_3 + 2.*x_1.^2.*x_2.^2.*y_2.^2.*y_3.^2 + 2.*x_1.^2.*x_2.^2.*y_2.^2.*z_3.^2 - 2.*x_1.^2.*x_2.^2.*y_2.*y_3.^3 - 2.*x_1.^2.*x_2.^2.*y_2.*y_3.*z_3.^2 + x_1.^2.*x_3.^4.*y_2.^2 - 2.*x_1.^2.*x_3.^2.*y_2.^3.*y_3 + 2.*x_1.^2.*x_3.^2.*y_2.^2.*y_3.^2 + 2.*x_1.^2.*x_3.^2.*y_2.^2.*z_3.^2 + x_1.^2.*y_2.^4.*y_3.^2 + x_1.^2.*y_2.^4.*z_3.^2 - 2.*x_1.^2.*y_2.^3.*y_3.^3 - 2.*x_1.^2.*y_2.^3.*y_3.*z_3.^2 + x_1.^2.*y_2.^2.*y_3.^4 + 2.*x_1.^2.*y_2.^2.*y_3.^2.*z_3.^2 + x_1.^2.*y_2.^2.*z_3.^4).^(1./2) - R_1.*x_1.*x_2.^3.*y_3.^2 - R_1.*x_1.*x_3.^3.*y_2.^2 - R_2.*x_1.^3.*x_2.*y_3.^2 - R_3.*x_1.^3.*x_3.*y_2.^2 - R_1.*x_1.*x_2.^3.*z_3.^2 - R_2.*x_1.^2.*y_2.*y_3.^3 - R_2.*x_1.^3.*x_2.*z_3.^2 - R_3.*x_1.^2.*y_2.^3.*y_3 + R_1.*R_2.^2.*x_1.*x_2.*y_3.^2 + R_1.^2.*R_2.*x_1.*x_2.*y_3.^2 + R_1.*R_3.^2.*x_1.*x_3.*y_2.^2 + R_1.^2.*R_3.*x_1.*x_3.*y_2.^2 + R_1.*R_2.^2.*x_1.*x_2.*z_3.^2 + R_1.^2.*R_2.*x_1.*x_2.*z_3.^2 + R_2.*R_3.^2.*x_1.^2.*y_2.*y_3 + R_2.^2.*R_3.*x_1.^2.*y_2.*y_3 - R_1.*x_1.*x_2.*y_2.^2.*y_3.^2 - R_1.*x_1.*x_3.*y_2.^2.*y_3.^2 - R_2.*x_1.^2.*x_3.^2.*y_2.*y_3 - R_3.*x_1.^2.*x_2.^2.*y_2.*y_3 - R_1.*x_1.*x_2.*y_2.^2.*z_3.^2 - R_1.*x_1.*x_3.*y_2.^2.*z_3.^2 - R_2.*x_1.^2.*y_2.*y_3.*z_3.^2 + R_1.*x_1.*x_2.*y_2.*y_3.^3 + R_1.*x_1.*x_3.*y_2.^3.*y_3 + R_2.*x_1.^3.*x_3.*y_2.*y_3 + R_3.*x_1.^3.*x_2.*y_2.*y_3 + 2.*R_1.^3.*x_2.*x_3.*y_2.*y_3 - R_1.*R_2.^2.*x_1.*x_3.*y_2.*y_3 - R_1.*R_3.^2.*x_1.*x_2.*y_2.*y_3 - R_1.^2.*R_2.*x_1.*x_3.*y_2.*y_3 - R_1.^2.*R_3.*x_1.*x_2.*y_2.*y_3 + R_1.*x_1.*x_2.*x_3.^2.*y_2.*y_3 + R_1.*x_1.*x_2.^2.*x_3.*y_2.*y_3 - 2.*R_1.*x_1.^2.*x_2.*x_3.*y_2.*y_3 + R_1.*x_1.*x_2.*y_2.*y_3.*z_3.^2)./(2.*(R_1.^2.*x_2.^2.*y_3.^2 + R_1.^2.*x_2.^2.*z_3.^2 - 2.*R_1.^2.*x_2.*x_3.*y_2.*y_3 + R_1.^2.*x_3.^2.*y_2.^2 + R_1.^2.*y_2.^2.*z_3.^2 - 2.*R_1.*R_2.*x_1.*x_2.*y_3.^2 - 2.*R_1.*R_2.*x_1.*x_2.*z_3.^2 + 2.*R_1.*R_2.*x_1.*x_3.*y_2.*y_3 + 2.*R_1.*R_3.*x_1.*x_2.*y_2.*y_3 - 2.*R_1.*R_3.*x_1.*x_3.*y_2.^2 + R_2.^2.*x_1.^2.*y_3.^2 + R_2.^2.*x_1.^2.*z_3.^2 - 2.*R_2.*R_3.*x_1.^2.*y_2.*y_3 + R_3.^2.*x_1.^2.*y_2.^2 - x_1.^2.*y_2.^2.*z_3.^2));
% R2 = @(R_1,R_2,R_3) -(R_1.^3.*x_2.^2.*y_3.^2 + R_1.^3.*x_3.^2.*y_2.^2 + R_2.^3.*x_1.^2.*y_3.^2 + R_3.^3.*x_1.^2.*y_2.^2 + R_1.^3.*x_2.^2.*z_3.^2 + R_2.^3.*x_1.^2.*z_3.^2 + R_1.^3.*y_2.^2.*z_3.^2 - R_1.*x_1.^2.*x_2.^2.*y_3.^2 - R_1.*x_1.^2.*x_3.^2.*y_2.^2 - R_2.*x_1.^2.*x_2.^2.*y_3.^2 - R_3.*x_1.^2.*x_3.^2.*y_2.^2 - R_1.*x_1.^2.*x_2.^2.*z_3.^2 - R_2.*x_1.^2.*x_2.^2.*z_3.^2 - R_2.*x_1.^2.*y_2.^2.*y_3.^2 - R_3.*x_1.^2.*y_2.^2.*y_3.^2 - R_1.*x_1.^2.*y_2.^2.*z_3.^2 - R_2.*x_1.^2.*y_2.^2.*z_3.^2 - R_3.*x_1.^2.*y_2.^2.*z_3.^2 + x_1.*y_2.*z_3.*(2.*R_1.^4.*R_2.*R_3.*x_2.*x_3 - R_1.^4.*R_2.^2.*y_3.^2 - R_1.^4.*R_2.^2.*z_3.^2 - R_1.^4.*R_2.^2.*x_3.^2 + 2.*R_1.^4.*R_2.*R_3.*y_2.*y_3 - R_1.^4.*R_3.^2.*x_2.^2 - R_1.^4.*R_3.^2.*y_2.^2 + R_1.^4.*x_2.^2.*y_3.^2 + R_1.^4.*x_2.^2.*z_3.^2 - 2.*R_1.^4.*x_2.*x_3.*y_2.*y_3 + R_1.^4.*x_3.^2.*y_2.^2 + R_1.^4.*y_2.^2.*z_3.^2 + 2.*R_1.^3.*R_2.^3.*x_3.^2 + 2.*R_1.^3.*R_2.^3.*y_3.^2 + 2.*R_1.^3.*R_2.^3.*z_3.^2 - 2.*R_1.^3.*R_2.^2.*R_3.*x_2.*x_3 - 2.*R_1.^3.*R_2.^2.*R_3.*y_2.*y_3 - 2.*R_1.^3.*R_2.*R_3.^2.*x_2.*x_3 - 2.*R_1.^3.*R_2.*R_3.^2.*y_2.*y_3 - 2.*R_1.^3.*R_2.*x_2.^2.*x_3.^2 - 2.*R_1.^3.*R_2.*x_2.^2.*y_3.^2 - 2.*R_1.^3.*R_2.*x_2.^2.*z_3.^2 + 2.*R_1.^3.*R_2.*x_2.*x_3.^3 + 2.*R_1.^3.*R_2.*x_2.*x_3.*y_3.^2 + 2.*R_1.^3.*R_2.*x_2.*x_3.*z_3.^2 - 2.*R_1.^3.*R_2.*x_3.^2.*y_2.^2 + 2.*R_1.^3.*R_2.*x_3.^2.*y_2.*y_3 - 2.*R_1.^3.*R_2.*y_2.^2.*y_3.^2 - 2.*R_1.^3.*R_2.*y_2.^2.*z_3.^2 + 2.*R_1.^3.*R_2.*y_2.*y_3.^3 + 2.*R_1.^3.*R_2.*y_2.*y_3.*z_3.^2 + 2.*R_1.^3.*R_3.^3.*x_2.^2 + 2.*R_1.^3.*R_3.^3.*y_2.^2 + 2.*R_1.^3.*R_3.*x_2.^3.*x_3 - 2.*R_1.^3.*R_3.*x_2.^2.*x_3.^2 + 2.*R_1.^3.*R_3.*x_2.^2.*y_2.*y_3 - 2.*R_1.^3.*R_3.*x_2.^2.*y_3.^2 - 2.*R_1.^3.*R_3.*x_2.^2.*z_3.^2 + 2.*R_1.^3.*R_3.*x_2.*x_3.*y_2.^2 - 2.*R_1.^3.*R_3.*x_3.^2.*y_2.^2 + 2.*R_1.^3.*R_3.*y_2.^3.*y_3 - 2.*R_1.^3.*R_3.*y_2.^2.*y_3.^2 - 2.*R_1.^3.*R_3.*y_2.^2.*z_3.^2 - R_1.^2.*R_2.^4.*x_3.^2 - R_1.^2.*R_2.^4.*y_3.^2 - R_1.^2.*R_2.^4.*z_3.^2 - 2.*R_1.^2.*R_2.^3.*R_3.*x_1.*x_3 + 2.*R_1.^2.*R_2.^2.*R_3.^2.*x_1.*x_2 + 2.*R_1.^2.*R_2.^2.*R_3.^2.*x_1.*x_3 + 2.*R_1.^2.*R_2.^2.*R_3.^2.*x_2.*x_3 + 2.*R_1.^2.*R_2.^2.*R_3.^2.*y_2.*y_3 + 2.*R_1.^2.*R_2.^2.*x_1.^2.*x_3.^2 + 2.*R_1.^2.*R_2.^2.*x_1.^2.*y_3.^2 + 2.*R_1.^2.*R_2.^2.*x_1.^2.*z_3.^2 - 2.*R_1.^2.*R_2.^2.*x_1.*x_2.*y_3.^2 - 2.*R_1.^2.*R_2.^2.*x_1.*x_2.*z_3.^2 - 2.*R_1.^2.*R_2.^2.*x_1.*x_3.^3 + 2.*R_1.^2.*R_2.^2.*x_1.*x_3.*y_2.*y_3 - 2.*R_1.^2.*R_2.^2.*x_1.*x_3.*y_3.^2 - 2.*R_1.^2.*R_2.^2.*x_1.*x_3.*z_3.^2 + 2.*R_1.^2.*R_2.^2.*x_2.^2.*x_3.^2 + 2.*R_1.^2.*R_2.^2.*x_2.^2.*y_3.^2 + 2.*R_1.^2.*R_2.^2.*x_2.^2.*z_3.^2 - 2.*R_1.^2.*R_2.^2.*x_2.*x_3.^3 - 2.*R_1.^2.*R_2.^2.*x_2.*x_3.*y_3.^2 - 2.*R_1.^2.*R_2.^2.*x_2.*x_3.*z_3.^2 + 2.*R_1.^2.*R_2.^2.*x_3.^2.*y_2.^2 - 2.*R_1.^2.*R_2.^2.*x_3.^2.*y_2.*y_3 + 2.*R_1.^2.*R_2.^2.*y_2.^2.*y_3.^2 + 2.*R_1.^2.*R_2.^2.*y_2.^2.*z_3.^2 - 2.*R_1.^2.*R_2.^2.*y_2.*y_3.^3 - 2.*R_1.^2.*R_2.^2.*y_2.*y_3.*z_3.^2 - 2.*R_1.^2.*R_2.*R_3.^3.*x_1.*x_2 - 4.*R_1.^2.*R_2.*R_3.*x_1.^2.*x_2.*x_3 - 4.*R_1.^2.*R_2.*R_3.*x_1.^2.*y_2.*y_3 + 2.*R_1.^2.*R_2.*R_3.*x_1.*x_2.^2.*x_3 + 2.*R_1.^2.*R_2.*R_3.*x_1.*x_2.*x_3.^2 + 2.*R_1.^2.*R_2.*R_3.*x_1.*x_2.*y_3.^2 + 2.*R_1.^2.*R_2.*R_3.*x_1.*x_2.*z_3.^2 + 2.*R_1.^2.*R_2.*R_3.*x_1.*x_3.*y_2.^2 - R_1.^2.*R_3.^4.*x_2.^2 - R_1.^2.*R_3.^4.*y_2.^2 + 2.*R_1.^2.*R_3.^2.*x_1.^2.*x_2.^2 + 2.*R_1.^2.*R_3.^2.*x_1.^2.*y_2.^2 - 2.*R_1.^2.*R_3.^2.*x_1.*x_2.^3 - 2.*R_1.^2.*R_3.^2.*x_1.*x_2.*y_2.^2 + 2.*R_1.^2.*R_3.^2.*x_1.*x_2.*y_2.*y_3 - 2.*R_1.^2.*R_3.^2.*x_1.*x_3.*y_2.^2 - 2.*R_1.^2.*R_3.^2.*x_2.^3.*x_3 + 2.*R_1.^2.*R_3.^2.*x_2.^2.*x_3.^2 - 2.*R_1.^2.*R_3.^2.*x_2.^2.*y_2.*y_3 + 2.*R_1.^2.*R_3.^2.*x_2.^2.*y_3.^2 + 2.*R_1.^2.*R_3.^2.*x_2.^2.*z_3.^2 - 2.*R_1.^2.*R_3.^2.*x_2.*x_3.*y_2.^2 + 2.*R_1.^2.*R_3.^2.*x_3.^2.*y_2.^2 - 2.*R_1.^2.*R_3.^2.*y_2.^3.*y_3 + 2.*R_1.^2.*R_3.^2.*y_2.^2.*y_3.^2 + 2.*R_1.^2.*R_3.^2.*y_2.^2.*z_3.^2 - 2.*R_1.^2.*x_1.^2.*x_2.^2.*y_3.^2 - 2.*R_1.^2.*x_1.^2.*x_2.^2.*z_3.^2 + 4.*R_1.^2.*x_1.^2.*x_2.*x_3.*y_2.*y_3 - 2.*R_1.^2.*x_1.^2.*x_3.^2.*y_2.^2 - 2.*R_1.^2.*x_1.^2.*y_2.^2.*z_3.^2 + 2.*R_1.^2.*x_1.*x_2.^3.*y_3.^2 + 2.*R_1.^2.*x_1.*x_2.^3.*z_3.^2 - 2.*R_1.^2.*x_1.*x_2.^2.*x_3.*y_2.*y_3 - 2.*R_1.^2.*x_1.*x_2.*x_3.^2.*y_2.*y_3 + 2.*R_1.^2.*x_1.*x_2.*y_2.^2.*y_3.^2 + 2.*R_1.^2.*x_1.*x_2.*y_2.^2.*z_3.^2 - 2.*R_1.^2.*x_1.*x_2.*y_2.*y_3.^3 - 2.*R_1.^2.*x_1.*x_2.*y_2.*y_3.*z_3.^2 + 2.*R_1.^2.*x_1.*x_3.^3.*y_2.^2 - 2.*R_1.^2.*x_1.*x_3.*y_2.^3.*y_3 + 2.*R_1.^2.*x_1.*x_3.*y_2.^2.*y_3.^2 + 2.*R_1.^2.*x_1.*x_3.*y_2.^2.*z_3.^2 - R_1.^2.*x_2.^4.*x_3.^2 - R_1.^2.*x_2.^4.*y_3.^2 - R_1.^2.*x_2.^4.*z_3.^2 + 2.*R_1.^2.*x_2.^3.*x_3.^3 + 2.*R_1.^2.*x_2.^3.*x_3.*y_3.^2 + 2.*R_1.^2.*x_2.^3.*x_3.*z_3.^2 - R_1.^2.*x_2.^2.*x_3.^4 - 2.*R_1.^2.*x_2.^2.*x_3.^2.*y_2.^2 + 2.*R_1.^2.*x_2.^2.*x_3.^2.*y_2.*y_3 - 2.*R_1.^2.*x_2.^2.*x_3.^2.*y_3.^2 - 2.*R_1.^2.*x_2.^2.*x_3.^2.*z_3.^2 - 2.*R_1.^2.*x_2.^2.*y_2.^2.*y_3.^2 - 2.*R_1.^2.*x_2.^2.*y_2.^2.*z_3.^2 + 2.*R_1.^2.*x_2.^2.*y_2.*y_3.^3 + 2.*R_1.^2.*x_2.^2.*y_2.*y_3.*z_3.^2 - R_1.^2.*x_2.^2.*y_3.^4 - 2.*R_1.^2.*x_2.^2.*y_3.^2.*z_3.^2 - R_1.^2.*x_2.^2.*z_3.^4 + 2.*R_1.^2.*x_2.*x_3.^3.*y_2.^2 + 2.*R_1.^2.*x_2.*x_3.*y_2.^2.*y_3.^2 + 2.*R_1.^2.*x_2.*x_3.*y_2.^2.*z_3.^2 - R_1.^2.*x_3.^4.*y_2.^2 - R_1.^2.*x_3.^2.*y_2.^4 + 2.*R_1.^2.*x_3.^2.*y_2.^3.*y_3 - 2.*R_1.^2.*x_3.^2.*y_2.^2.*y_3.^2 - 2.*R_1.^2.*x_3.^2.*y_2.^2.*z_3.^2 - R_1.^2.*y_2.^4.*y_3.^2 - R_1.^2.*y_2.^4.*z_3.^2 + 2.*R_1.^2.*y_2.^3.*y_3.^3 + 2.*R_1.^2.*y_2.^3.*y_3.*z_3.^2 - R_1.^2.*y_2.^2.*y_3.^4 - 2.*R_1.^2.*y_2.^2.*y_3.^2.*z_3.^2 - R_1.^2.*y_2.^2.*z_3.^4 + 2.*R_1.*R_2.^4.*R_3.*x_1.*x_3 - 2.*R_1.*R_2.^3.*R_3.^2.*x_1.*x_3 - 2.*R_1.*R_2.^3.*x_1.^2.*x_3.^2 - 2.*R_1.*R_2.^3.*x_1.^2.*y_3.^2 - 2.*R_1.*R_2.^3.*x_1.^2.*z_3.^2 + 2.*R_1.*R_2.^3.*x_1.*x_3.^3 + 2.*R_1.*R_2.^3.*x_1.*x_3.*y_3.^2 + 2.*R_1.*R_2.^3.*x_1.*x_3.*z_3.^2 - 2.*R_1.*R_2.^2.*R_3.^3.*x_1.*x_2 + 2.*R_1.*R_2.^2.*R_3.*x_1.^2.*x_2.*x_3 + 2.*R_1.*R_2.^2.*R_3.*x_1.^2.*y_2.*y_3 - 4.*R_1.*R_2.^2.*R_3.*x_1.*x_2.^2.*x_3 + 2.*R_1.*R_2.^2.*R_3.*x_1.*x_2.*x_3.^2 + 2.*R_1.*R_2.^2.*R_3.*x_1.*x_2.*y_3.^2 + 2.*R_1.*R_2.^2.*R_3.*x_1.*x_2.*z_3.^2 - 4.*R_1.*R_2.^2.*R_3.*x_1.*x_3.*y_2.^2 + 2.*R_1.*R_2.*R_3.^4.*x_1.*x_2 + 2.*R_1.*R_2.*R_3.^2.*x_1.^2.*x_2.*x_3 + 2.*R_1.*R_2.*R_3.^2.*x_1.^2.*y_2.*y_3 + 2.*R_1.*R_2.*R_3.^2.*x_1.*x_2.^2.*x_3 - 4.*R_1.*R_2.*R_3.^2.*x_1.*x_2.*x_3.^2 - 4.*R_1.*R_2.*R_3.^2.*x_1.*x_2.*y_3.^2 - 4.*R_1.*R_2.*R_3.^2.*x_1.*x_2.*z_3.^2 + 2.*R_1.*R_2.*R_3.^2.*x_1.*x_3.*y_2.^2 + 2.*R_1.*R_2.*x_1.^2.*x_2.^2.*x_3.^2 + 2.*R_1.*R_2.*x_1.^2.*x_2.^2.*y_3.^2 + 2.*R_1.*R_2.*x_1.^2.*x_2.^2.*z_3.^2 - 2.*R_1.*R_2.*x_1.^2.*x_2.*x_3.^3 - 2.*R_1.*R_2.*x_1.^2.*x_2.*x_3.*y_3.^2 - 2.*R_1.*R_2.*x_1.^2.*x_2.*x_3.*z_3.^2 + 2.*R_1.*R_2.*x_1.^2.*x_3.^2.*y_2.^2 - 2.*R_1.*R_2.*x_1.^2.*x_3.^2.*y_2.*y_3 + 2.*R_1.*R_2.*x_1.^2.*y_2.^2.*y_3.^2 + 2.*R_1.*R_2.*x_1.^2.*y_2.^2.*z_3.^2 - 2.*R_1.*R_2.*x_1.^2.*y_2.*y_3.^3 - 2.*R_1.*R_2.*x_1.^2.*y_2.*y_3.*z_3.^2 - 2.*R_1.*R_2.*x_1.*x_2.^2.*x_3.^3 - 2.*R_1.*R_2.*x_1.*x_2.^2.*x_3.*y_3.^2 - 2.*R_1.*R_2.*x_1.*x_2.^2.*x_3.*z_3.^2 + 2.*R_1.*R_2.*x_1.*x_2.*x_3.^4 + 4.*R_1.*R_2.*x_1.*x_2.*x_3.^2.*y_3.^2 + 4.*R_1.*R_2.*x_1.*x_2.*x_3.^2.*z_3.^2 + 2.*R_1.*R_2.*x_1.*x_2.*y_3.^4 + 4.*R_1.*R_2.*x_1.*x_2.*y_3.^2.*z_3.^2 + 2.*R_1.*R_2.*x_1.*x_2.*z_3.^4 - 2.*R_1.*R_2.*x_1.*x_3.^3.*y_2.^2 - 2.*R_1.*R_2.*x_1.*x_3.*y_2.^2.*y_3.^2 - 2.*R_1.*R_2.*x_1.*x_3.*y_2.^2.*z_3.^2 - 2.*R_1.*R_3.^3.*x_1.^2.*x_2.^2 - 2.*R_1.*R_3.^3.*x_1.^2.*y_2.^2 + 2.*R_1.*R_3.^3.*x_1.*x_2.^3 + 2.*R_1.*R_3.^3.*x_1.*x_2.*y_2.^2 - 2.*R_1.*R_3.*x_1.^2.*x_2.^3.*x_3 + 2.*R_1.*R_3.*x_1.^2.*x_2.^2.*x_3.^2 - 2.*R_1.*R_3.*x_1.^2.*x_2.^2.*y_2.*y_3 + 2.*R_1.*R_3.*x_1.^2.*x_2.^2.*y_3.^2 + 2.*R_1.*R_3.*x_1.^2.*x_2.^2.*z_3.^2 - 2.*R_1.*R_3.*x_1.^2.*x_2.*x_3.*y_2.^2 + 2.*R_1.*R_3.*x_1.^2.*x_3.^2.*y_2.^2 - 2.*R_1.*R_3.*x_1.^2.*y_2.^3.*y_3 + 2.*R_1.*R_3.*x_1.^2.*y_2.^2.*y_3.^2 + 2.*R_1.*R_3.*x_1.^2.*y_2.^2.*z_3.^2 + 2.*R_1.*R_3.*x_1.*x_2.^4.*x_3 - 2.*R_1.*R_3.*x_1.*x_2.^3.*x_3.^2 - 2.*R_1.*R_3.*x_1.*x_2.^3.*y_3.^2 - 2.*R_1.*R_3.*x_1.*x_2.^3.*z_3.^2 + 4.*R_1.*R_3.*x_1.*x_2.^2.*x_3.*y_2.^2 - 2.*R_1.*R_3.*x_1.*x_2.*x_3.^2.*y_2.^2 - 2.*R_1.*R_3.*x_1.*x_2.*y_2.^2.*y_3.^2 - 2.*R_1.*R_3.*x_1.*x_2.*y_2.^2.*z_3.^2 + 2.*R_1.*R_3.*x_1.*x_3.*y_2.^4 - R_2.^4.*R_3.^2.*x_1.^2 + R_2.^4.*x_1.^2.*y_3.^2 + R_2.^4.*x_1.^2.*z_3.^2 + 2.*R_2.^3.*R_3.^3.*x_1.^2 + 2.*R_2.^3.*R_3.*x_1.^3.*x_3 - 2.*R_2.^3.*R_3.*x_1.^2.*x_3.^2 - 2.*R_2.^3.*R_3.*x_1.^2.*y_3.^2 - 2.*R_2.^3.*R_3.*x_1.^2.*z_3.^2 - R_2.^2.*R_3.^4.*x_1.^2 - 2.*R_2.^2.*R_3.^2.*x_1.^3.*x_2 - 2.*R_2.^2.*R_3.^2.*x_1.^3.*x_3 + 2.*R_2.^2.*R_3.^2.*x_1.^2.*x_2.^2 + 2.*R_2.^2.*R_3.^2.*x_1.^2.*x_3.^2 + 2.*R_2.^2.*R_3.^2.*x_1.^2.*y_2.^2 - 2.*R_2.^2.*R_3.^2.*x_1.^2.*y_2.*y_3 + 2.*R_2.^2.*R_3.^2.*x_1.^2.*y_3.^2 + 2.*R_2.^2.*R_3.^2.*x_1.^2.*z_3.^2 - R_2.^2.*x_1.^4.*x_3.^2 - R_2.^2.*x_1.^4.*y_3.^2 - R_2.^2.*x_1.^4.*z_3.^2 + 2.*R_2.^2.*x_1.^3.*x_2.*y_3.^2 + 2.*R_2.^2.*x_1.^3.*x_2.*z_3.^2 + 2.*R_2.^2.*x_1.^3.*x_3.^3 - 2.*R_2.^2.*x_1.^3.*x_3.*y_2.*y_3 + 2.*R_2.^2.*x_1.^3.*x_3.*y_3.^2 + 2.*R_2.^2.*x_1.^3.*x_3.*z_3.^2 - 2.*R_2.^2.*x_1.^2.*x_2.^2.*y_3.^2 - 2.*R_2.^2.*x_1.^2.*x_2.^2.*z_3.^2 - R_2.^2.*x_1.^2.*x_3.^4 + 2.*R_2.^2.*x_1.^2.*x_3.^2.*y_2.*y_3 - 2.*R_2.^2.*x_1.^2.*x_3.^2.*y_3.^2 - 2.*R_2.^2.*x_1.^2.*x_3.^2.*z_3.^2 - 2.*R_2.^2.*x_1.^2.*y_2.^2.*y_3.^2 - 2.*R_2.^2.*x_1.^2.*y_2.^2.*z_3.^2 + 2.*R_2.^2.*x_1.^2.*y_2.*y_3.^3 + 2.*R_2.^2.*x_1.^2.*y_2.*y_3.*z_3.^2 - R_2.^2.*x_1.^2.*y_3.^4 - 2.*R_2.^2.*x_1.^2.*y_3.^2.*z_3.^2 - R_2.^2.*x_1.^2.*z_3.^4 + 2.*R_2.*R_3.^3.*x_1.^3.*x_2 - 2.*R_2.*R_3.^3.*x_1.^2.*x_2.^2 - 2.*R_2.*R_3.^3.*x_1.^2.*y_2.^2 + 2.*R_2.*R_3.*x_1.^4.*x_2.*x_3 + 2.*R_2.*R_3.*x_1.^4.*y_2.*y_3 - 2.*R_2.*R_3.*x_1.^3.*x_2.^2.*x_3 - 2.*R_2.*R_3.*x_1.^3.*x_2.*x_3.^2 - 2.*R_2.*R_3.*x_1.^3.*x_2.*y_3.^2 - 2.*R_2.*R_3.*x_1.^3.*x_2.*z_3.^2 - 2.*R_2.*R_3.*x_1.^3.*x_3.*y_2.^2 + 2.*R_2.*R_3.*x_1.^2.*x_2.^2.*x_3.^2 + 2.*R_2.*R_3.*x_1.^2.*x_2.^2.*y_3.^2 + 2.*R_2.*R_3.*x_1.^2.*x_2.^2.*z_3.^2 + 2.*R_2.*R_3.*x_1.^2.*x_3.^2.*y_2.^2 + 2.*R_2.*R_3.*x_1.^2.*y_2.^2.*y_3.^2 + 2.*R_2.*R_3.*x_1.^2.*y_2.^2.*z_3.^2 + R_3.^4.*x_1.^2.*y_2.^2 - R_3.^2.*x_1.^4.*x_2.^2 - R_3.^2.*x_1.^4.*y_2.^2 + 2.*R_3.^2.*x_1.^3.*x_2.^3 + 2.*R_3.^2.*x_1.^3.*x_2.*y_2.^2 - 2.*R_3.^2.*x_1.^3.*x_2.*y_2.*y_3 + 2.*R_3.^2.*x_1.^3.*x_3.*y_2.^2 - R_3.^2.*x_1.^2.*x_2.^4 - 2.*R_3.^2.*x_1.^2.*x_2.^2.*y_2.^2 + 2.*R_3.^2.*x_1.^2.*x_2.^2.*y_2.*y_3 - 2.*R_3.^2.*x_1.^2.*x_3.^2.*y_2.^2 - R_3.^2.*x_1.^2.*y_2.^4 + 2.*R_3.^2.*x_1.^2.*y_2.^3.*y_3 - 2.*R_3.^2.*x_1.^2.*y_2.^2.*y_3.^2 - 2.*R_3.^2.*x_1.^2.*y_2.^2.*z_3.^2 + x_1.^4.*x_2.^2.*y_3.^2 + x_1.^4.*x_2.^2.*z_3.^2 - 2.*x_1.^4.*x_2.*x_3.*y_2.*y_3 + x_1.^4.*x_3.^2.*y_2.^2 + x_1.^4.*y_2.^2.*z_3.^2 - 2.*x_1.^3.*x_2.^3.*y_3.^2 - 2.*x_1.^3.*x_2.^3.*z_3.^2 + 2.*x_1.^3.*x_2.^2.*x_3.*y_2.*y_3 + 2.*x_1.^3.*x_2.*x_3.^2.*y_2.*y_3 - 2.*x_1.^3.*x_2.*y_2.^2.*y_3.^2 - 2.*x_1.^3.*x_2.*y_2.^2.*z_3.^2 + 2.*x_1.^3.*x_2.*y_2.*y_3.^3 + 2.*x_1.^3.*x_2.*y_2.*y_3.*z_3.^2 - 2.*x_1.^3.*x_3.^3.*y_2.^2 + 2.*x_1.^3.*x_3.*y_2.^3.*y_3 - 2.*x_1.^3.*x_3.*y_2.^2.*y_3.^2 - 2.*x_1.^3.*x_3.*y_2.^2.*z_3.^2 + x_1.^2.*x_2.^4.*y_3.^2 + x_1.^2.*x_2.^4.*z_3.^2 - 2.*x_1.^2.*x_2.^2.*x_3.^2.*y_2.*y_3 + 2.*x_1.^2.*x_2.^2.*y_2.^2.*y_3.^2 + 2.*x_1.^2.*x_2.^2.*y_2.^2.*z_3.^2 - 2.*x_1.^2.*x_2.^2.*y_2.*y_3.^3 - 2.*x_1.^2.*x_2.^2.*y_2.*y_3.*z_3.^2 + x_1.^2.*x_3.^4.*y_2.^2 - 2.*x_1.^2.*x_3.^2.*y_2.^3.*y_3 + 2.*x_1.^2.*x_3.^2.*y_2.^2.*y_3.^2 + 2.*x_1.^2.*x_3.^2.*y_2.^2.*z_3.^2 + x_1.^2.*y_2.^4.*y_3.^2 + x_1.^2.*y_2.^4.*z_3.^2 - 2.*x_1.^2.*y_2.^3.*y_3.^3 - 2.*x_1.^2.*y_2.^3.*y_3.*z_3.^2 + x_1.^2.*y_2.^2.*y_3.^4 + 2.*x_1.^2.*y_2.^2.*y_3.^2.*z_3.^2 + x_1.^2.*y_2.^2.*z_3.^4).^(1./2) + R_1.*x_1.*x_2.^3.*y_3.^2 + R_1.*x_1.*x_3.^3.*y_2.^2 + R_2.*x_1.^3.*x_2.*y_3.^2 + R_3.*x_1.^3.*x_3.*y_2.^2 + R_1.*x_1.*x_2.^3.*z_3.^2 + R_2.*x_1.^2.*y_2.*y_3.^3 + R_2.*x_1.^3.*x_2.*z_3.^2 + R_3.*x_1.^2.*y_2.^3.*y_3 - R_1.*R_2.^2.*x_1.*x_2.*y_3.^2 - R_1.^2.*R_2.*x_1.*x_2.*y_3.^2 - R_1.*R_3.^2.*x_1.*x_3.*y_2.^2 - R_1.^2.*R_3.*x_1.*x_3.*y_2.^2 - R_1.*R_2.^2.*x_1.*x_2.*z_3.^2 - R_1.^2.*R_2.*x_1.*x_2.*z_3.^2 - R_2.*R_3.^2.*x_1.^2.*y_2.*y_3 - R_2.^2.*R_3.*x_1.^2.*y_2.*y_3 + R_1.*x_1.*x_2.*y_2.^2.*y_3.^2 + R_1.*x_1.*x_3.*y_2.^2.*y_3.^2 + R_2.*x_1.^2.*x_3.^2.*y_2.*y_3 + R_3.*x_1.^2.*x_2.^2.*y_2.*y_3 + R_1.*x_1.*x_2.*y_2.^2.*z_3.^2 + R_1.*x_1.*x_3.*y_2.^2.*z_3.^2 + R_2.*x_1.^2.*y_2.*y_3.*z_3.^2 - R_1.*x_1.*x_2.*y_2.*y_3.^3 - R_1.*x_1.*x_3.*y_2.^3.*y_3 - R_2.*x_1.^3.*x_3.*y_2.*y_3 - R_3.*x_1.^3.*x_2.*y_2.*y_3 - 2.*R_1.^3.*x_2.*x_3.*y_2.*y_3 + R_1.*R_2.^2.*x_1.*x_3.*y_2.*y_3 + R_1.*R_3.^2.*x_1.*x_2.*y_2.*y_3 + R_1.^2.*R_2.*x_1.*x_3.*y_2.*y_3 + R_1.^2.*R_3.*x_1.*x_2.*y_2.*y_3 - R_1.*x_1.*x_2.*x_3.^2.*y_2.*y_3 - R_1.*x_1.*x_2.^2.*x_3.*y_2.*y_3 + 2.*R_1.*x_1.^2.*x_2.*x_3.*y_2.*y_3 - R_1.*x_1.*x_2.*y_2.*y_3.*z_3.^2)./(2.*(R_1.^2.*x_2.^2.*y_3.^2 + R_1.^2.*x_2.^2.*z_3.^2 - 2.*R_1.^2.*x_2.*x_3.*y_2.*y_3 + R_1.^2.*x_3.^2.*y_2.^2 + R_1.^2.*y_2.^2.*z_3.^2 - 2.*R_1.*R_2.*x_1.*x_2.*y_3.^2 - 2.*R_1.*R_2.*x_1.*x_2.*z_3.^2 + 2.*R_1.*R_2.*x_1.*x_3.*y_2.*y_3 + 2.*R_1.*R_3.*x_1.*x_2.*y_2.*y_3 - 2.*R_1.*R_3.*x_1.*x_3.*y_2.^2 + R_2.^2.*x_1.^2.*y_3.^2 + R_2.^2.*x_1.^2.*z_3.^2 - 2.*R_2.*R_3.*x_1.^2.*y_2.*y_3 + R_3.^2.*x_1.^2.*y_2.^2 - x_1.^2.*y_2.^2.*z_3.^2));

var_1 = ( ( y_2*y_3 - x_3^2 + x_1*x_3 - y_3^2 + (x_2^2*y_3-x_1*x_2*y_3)/(y_2) )/( z_3^2 ) - 1 );
var_2 = ( x_1*x_2*y_3^2-x_2^2*z_3^2-x_2^2*y_3^2+x_1*x_2*z_3^2+x_3^2*y_2*y_3-x_1*x_3*y_2*y_3-y_2^2*y_3^2-y_2^2*z_3^2+y_2*y_3^3+y_2*y_3*z_3^2 )/( y_2^2*z_3^2 );
var_3 = ( x_2^2*y_3^2+x_2^2*z_3^2-2*x_2*x_3*y_2*y_3+x_3^2*y_2^2+y_2^2*z_3^2 )/( x_1^2*y_2^2*z_3^2 );
var_4 = ( x_2*y_3^2-x_3*y_2*y_3+x_2*z_3^2 )/( x_1*y_2^2*z_3^2 );
var_5 = ( x_2*y_3-x_3*y_2 )/( x_1*y_2*z_3^2 );
var_6 = ( y_3^2 + z_3^2 )/( y_2^2*z_3^2 );
var_7 = ( ( x_2^3*y_3^2+x_2^3*z_3^2-x_2^2*x_3*y_2*y_3-x_2*x_3^2*y_2*y_3+x_2*y_2^2*y_3^2+x_2*y_2^2*z_3^2-x_2*y_2*y_3^3-x_2*y_2*y_3*z_3^2+x_3^3*y_2^2-x_3*y_2^3*y_3+x_3*y_2^2*y_3^2+x_3*y_2^2*z_3^2 )/( x_1*y_2^2*z_3^2 )...
      - ( x_2^2*y_3^2+x_2^2*z_3^2-2*x_2*x_3*y_2*y_3+x_3^2*y_2^2 )/( y_2^2*z_3^2 ) - 1 );
var_8 = ( y_3 )/( y_2*z_3^2 );
var_9 = z_3^2; % 1/var_9
var_0 = ( x_1^2*x_2^2*y_3^2+x_1^2*x_2^2*z_3^2-2*x_1^2*x_2*x_3*y_2*y_3+x_1^2*x_3^2*y_2^2+x_1^2*y_2^2*z_3^2-2*x_1*x_2^3*y_3^2-2*x_1*x_2^3*z_3^2+2*x_1*x_2^2*x_3*y_2*y_3+2*x_1*x_2*x_3^2*y_2*y_3-2*x_1*x_2*y_2^2*y_3^2-2*x_1*x_2*y_2^2*z_3^2+2*x_1*x_2*y_2*y_3^3+2*x_1*x_2*y_2*y_3*z_3^2-2*x_1*x_3^3*y_2^2+2*x_1*x_3*y_2^3*y_3-2*x_1*x_3*y_2^2*y_3^2-2*x_1*x_3*y_2^2*z_3^2+x_2^4*y_3^2+x_2^4*z_3^2-2*x_2^2*x_3^2*y_2*y_3+2*x_2^2*y_2^2*y_3^2+2*x_2^2*y_2^2*z_3^2-2*x_2^2*y_2*y_3^3-2*x_2^2*y_2*y_3*z_3^2+x_3^4*y_2^2-2*x_3^2*y_2^3*y_3+2*x_3^2*y_2^2*y_3^2+2*x_3^2*y_2^2*z_3^2+y_2^4*y_3^2+y_2^4*z_3^2-2*y_2^3*y_3^3-2*y_2^3*y_3*z_3^2+y_2^2*y_3^4+2*y_2^2*y_3^2*z_3^2+y_2^2*z_3^4 ) / ( 4*y_2^2*z_3^2 );
  

A = @(R_1,R_2,R_3) ...
    R_3.*R_3./var_9 ... 
  - 1 ...
  - R_2.*R_3.*var_8.*2 ...
  + R_2.*R_2.*( var_6 ) ...
  + R_1.*R_3.*( 2.*var_5 ) ...
  - R_1.*R_2.*( 2.*var_4 ) ...
  + R_1.*R_1.*var_3;

B = @(R_1,R_2,R_3) ...
    R_3.*var_1 ...
  + R_3.^3./var_9 ... 
  + R_2.*var_2 ...
  - ( R_2.*R_3.^2 + R_2.^2.*R_3 ).*var_8 ...
  + R_2.^3.*var_6 ...
  + R_1.*var_7 ...
  + (R_1.*R_3.^2 + R_1.^2.*R_3).*var_5 ...
  - (R_1.*R_2.^2 + R_1.^2.*R_2).*var_4 ...                       
  + R_1.^3.*var_3;

C = @(R_1,R_2,R_3) ...
    var_0 ...
  + R_3.^2.*var_1./2 ...
  + R_3.^4./(var_9.*4) ...
  + R_2.^2.*var_2./2 ...
  - R_2.^2.*R_3.^2.*var_8./2 ...
  + R_2.^4.*var_6./4 ...
  + R_1.^2.*var_7./2 ...
  + R_1.^2.*R_3.^2.*var_5./2 ...
  - R_1.^2.*R_2.^2.*var_4./2 ...
  + R_1.^4.*var_3./4;
  
D0 = @(R_1,R_2,R_3) sqrt(B(R_1,R_2,R_3).^2-4.*A(R_1,R_2,R_3).*C(R_1,R_2,R_3))
R1 = @(R_1,R_2,R_3) ( -B(R_1,R_2,R_3) + D0(R_1,R_2,R_3).*(imag(D0(R_1,R_2,R_3))==0) )./( 2.*A(R_1,R_2,R_3) ) 
R2 = @(R_1,R_2,R_3) ( -B(R_1,R_2,R_3) - D0(R_1,R_2,R_3).*(imag(D0(R_1,R_2,R_3))==0) )./( 2.*A(R_1,R_2,R_3) ) 


% Distance to goal

R_0 = (Target(:,1).^2 + Target(:,2).^2 + Target(:,3).^2).^(1/2);

R_1 = ( (Target(:,1) - x_1).^2 + (Target(:,2)      ).^2 + (Target(:,3)      ).^2 ).^(1/2) - R_0;
R_2 = ( (Target(:,1) - x_2).^2 + (Target(:,2) - y_2).^2 + (Target(:,3)      ).^2 ).^(1/2) - R_0;
R_3 = ( (Target(:,1) - x_3).^2 + (Target(:,2) - y_3).^2 + (Target(:,3) - z_3).^2 ).^(1/2) - R_0;

% Variables

% syms r1 r2 r3; R(r1,r2,r3)

D(:,1) = R1(R_1,R_2,R_3);
D(:,2) = R2(R_1,R_2,R_3);
% D(1)
% D(2)
% R_0;

for s = 1:2

    x(:,s) = -( R_1.^2+2.*D(:,s).*R_1-x_1.^2 ) ./ ( 2.*x_1 );
    y(:,s) = ( x_2.*R_1.^2+2.*D(:,s).*x_2.*R_1 ) ./ ( 2.*x_1.*y_2 ) - ...
        ( R_2.^2+2.*D(:,s).*R_2-x_2.^2-y_2.^2+x_1.*x_2 ) ./ ( 2.*y_2 );
    z(:,s) = ( R_1.^2.*x_3.*y_2-R_1.^2.*x_2.*y_3-2.*D(:,s).*R_1.*x_2.*y_3+2.*D(:,s).*R_1.*x_3.*y_2+...
        R_2.^2.*x_1.*y_3+2.*D(:,s).*R_2.*x_1.*y_3-R_3.^2.*x_1.*y_2-2.*D(:,s).*R_3.*x_1.*y_2+...
        x_1.^2.*x_2.*y_3-x_1.^2.*x_3.*y_2-x_1.*x_2.^2.*y_3+x_1.*x_3.^2.*y_2-...
        x_1.*y_2.^2.*y_3+x_1.*y_2.*y_3.^2+x_1.*y_2.*z_3.^2 ) ./ ( 2.*x_1.*y_2.*z_3 );


    error(:,s) = (abs(( (x(s) - x_1)^2 + y(s)^2 + z(s)^2 )^(1/2) - D(:,s) - R_1) + abs(( (x(s) - x_2)^2 +...
        (y(s) - y_2)^2 + z(s)^2 )^(1/2) - D(:,s) - R_2) + abs(( (x(s) - x_3)^2 + (y(s) - y_3)^2 +...
        (z(s) - z_3)^2 )^(1/2) - D(:,s) - R_3) )/3;
   
    V(:,:,s) = [x(:,s), y(:,s), z(:,s)];

    Vector(:,:,s) = xyz_1_To_XYZ_2( V(:,1,s),V(:,2,s),V(:,3,s),a,b,g,z00,y00,x00);
    
    Peling_(:,:,s) = xyz_To_DPZ( V(:,1),V(:,2),V(:,3) );
    % Пелінг від координат: [0,0,0]
    Peling(:,:,s) = xyz_To_DPZ( Vector(:,1,s),Vector(:,2,s),Vector(:,3,s) );
    % Пелінг від координат: [x00,y00,z00]
    Peling_0(:,:,s) = xyz_To_DPZ( Vector(:,1,s) - x00,Vector(:,2,s) - y00,Vector(:,3,s) - z00 );
    % Пелінг від координат: [x10,y10,z10]
    Peling_1(:,:,s) = xyz_To_DPZ( Vector(:,1,s) - x10,Vector(:,2,s) - y10,Vector(:,3,s) - z10 );
    % Пелінг від координат: [x20,y20,z20]
    Peling_2(:,:,s) = xyz_To_DPZ( Vector(:,1,s) - x20,Vector(:,2,s) - y20,Vector(:,3,s) - z20 );
    % Пелінг від координат: [x30,y30,z30]
    Peling_3(:,:,s) = xyz_To_DPZ( Vector(:,1,s) - x30,Vector(:,2,s) - y30,Vector(:,3,s) - z30 );
end
% 'Деяка кількість загалом знайдених коренів впорядкованих за похибкою'
% roots

%format long g
'Пелінг від координат центральго РЛС: [x00,y00,z00]'
Peling_0
'Пелінг від координат першого РЛС: [x10,y10,z10]'
Peling_1
'Пелінг від координат другого РЛС: [x20,y20,z20]'
Peling_2
'Пелінг від координат третього РЛС: [x30,y30,z30]'
Peling_3
'Пелінг від початку координат: [0,0,0]'
Peling
'Координати цілі в нормальній декартовій системі'
Vector
'Координати цілі в повернутій декартовій системі'
V
%Peling_0(:,2) / pi * 180
'Похибка підрахунків'
%error
% [((abs( D(:,1) - R_0 )) > (abs( D(:,2) - R_0 ))) ,...
%     (abs( D(:,1) - R_0 )),...
%     (abs( D(:,2) - R_0 )),...
%     Peling_0(:,3,1),...
%     Peling_0(:,3,2)]
% %[D(1:100,1), D(1:100,2), Peling_0( 1:100,2 )]
% [ ((abs( D(:,1) - R_0 )) > (abs( D(:,2) - R_0 ))), ...
%     D0(R_1,R_2,R_3).*(imag(D0(R_1,R_2,R_3))==0), ...
%     error(:,1) -...
%     error(:,2),...
%     Peling0(:,2)/pi*180
%     ]

Peling_0


















